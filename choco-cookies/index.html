<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Choco-Cookies - Las Mejores Galletas de Guayaquil</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts: Pacifico para t√≠tulos, Inter para el resto -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Pacifico&display=swap" rel="stylesheet">
    
    <!-- Font Awesome para √≠conos -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <!-- Estilos personalizados -->
    <style>
        body { font-family: 'Inter', sans-serif; scroll-behavior: smooth; }
        .font-pacifico { font-family: 'Pacifico', cursive; }
        
        /* --- Animaciones y Efectos Pro --- */
        .cart-item-enter { animation: slide-in 0.3s ease-out forwards; }
        @keyframes slide-in { from { opacity: 0; transform: translateX(20px); } to { opacity: 1; transform: translateX(0); } }
        
        .toast-enter { animation: fade-in-up 0.5s ease-out forwards; }
        .toast-exit { animation: fade-out 0.5s ease-in forwards; }
        @keyframes fade-in-up { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes fade-out { from { opacity: 1; } to { opacity: 0; } }

        .scroll-animate { opacity: 0; transform: translateY(30px); transition: opacity 0.6s ease-out, transform 0.6s ease-out; }
        .scroll-animate.is-visible { opacity: 1; transform: translateY(0); }
        
        .btn-glow { transition: all 0.3s ease; }
        .btn-glow:hover { box-shadow: 0 0 15px rgba(168, 85, 247, 0.6); transform: scale(1.05); }

        .card-glow:hover { box-shadow: 0 5px 25px rgba(168, 85, 247, 0.2); }
        
        /* Estilos para el scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #fdf2e9; }
        ::-webkit-scrollbar-thumb { background: #c084fc; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #a855f7; }

        /* Estilos del Chatbot */
        #chatbot-window { transition: all 0.3s ease-in-out; }
        #chat-messages { scrollbar-width: thin; scrollbar-color: #a855f7 #f3e8ff; }
        .chat-bubble { max-width: 85%; }
        .chat-bubble-bot { background-color: #f3e8ff; border-radius: 20px 20px 20px 5px; }
        .chat-bubble-user { background-color: #e2e8f0; border-radius: 20px 20px 5px 20px; }
    </style>
</head>
<body class="bg-[#FFF7F0] text-gray-800">

    <!-- ========== HEADER ========== -->
    <header class="bg-white/80 backdrop-blur-lg sticky top-0 z-40 shadow-md transition-shadow duration-300">
        <nav class="container mx-auto px-6 py-3 flex justify-between items-center">
            <a href="#" class="font-pacifico text-3xl text-purple-600">Choco-Cookies</a>
            <div class="flex items-center space-x-4">
                <a href="#promociones" class="hidden md:block text-gray-600 hover:text-purple-600 transition-colors font-semibold">Promos</a>
                <a href="#productos" class="hidden md:block text-gray-600 hover:text-purple-600 transition-colors">Men√∫</a>
                <a href="#cursos" class="hidden md:block text-gray-600 hover:text-purple-600 transition-colors">Cursos</a>
                <a href="#why-us" class="hidden md:block text-gray-600 hover:text-purple-600 transition-colors">Nosotros</a>
                <button id="cart-button" class="relative text-gray-600 hover:text-purple-600 transition-colors">
                    <i class="fas fa-shopping-cart text-2xl"></i>
                    <span id="cart-count" class="absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center">0</span>
                </button>
            </div>
        </nav>
    </header>

    <main>
        <!-- ========== HERO SECTION (HOOK) ========== -->
        <section class="relative h-[70vh] md:h-[90vh] flex items-center justify-center text-center text-white overflow-hidden">
            <div class="absolute inset-0 bg-black/50 z-10"></div>
            <img src="https://images.pexels.com/photos/2067396/pexels-photo-2067396.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1" 
                 onerror="this.onerror=null;this.src='https://placehold.co/1920x1080/60281e/ffffff?text=Galletas+Deliciosas';" 
                 alt="[Imagen de galletas reci√©n horneadas esparcidas sobre una mesa]" 
                 class="absolute inset-0 w-full h-full object-cover">
            <div class="relative z-20 p-4">
                <h1 class="font-pacifico text-5xl md:text-7xl lg:text-8xl drop-shadow-lg animate-fade-in-up">El Sabor que te Abraza el Alma</h1>
                <p class="mt-4 text-lg md:text-2xl max-w-2xl mx-auto drop-shadow-md">Reci√©n horneadas en Guayaquil, con amor y los mejores ingredientes, directo a tu coraz√≥n.</p>
                <div class="mt-8 flex flex-col sm:flex-row items-center justify-center gap-4">
                    <a href="#productos" class="w-full sm:w-auto inline-block bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white font-bold py-3 px-8 rounded-full shadow-lg btn-glow">
                        üç™ ¬°Quiero Mis Galletas!
                    </a>
                     <a href="#promociones" class="w-full sm:w-auto inline-block bg-gradient-to-r from-amber-400 to-yellow-500 hover:from-amber-500 hover:to-yellow-600 text-gray-800 font-bold py-3 px-8 rounded-full shadow-lg btn-glow">
                        üî• Ver Promociones
                    </a>
                </div>
            </div>
        </section>

        <!-- ========== WHY US SECTION ========== -->
        <section id="why-us" class="py-16 md:py-24">
            <div class="container mx-auto px-6 scroll-animate">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-12 text-center">
                    <div class="flex flex-col items-center">
                        <div class="text-4xl text-white bg-purple-500 rounded-full w-20 h-20 flex items-center justify-center mb-4 shadow-lg"><i class="fas fa-seedling"></i></div>
                        <h3 class="text-2xl font-bold mb-2">Ingredientes Frescos</h3>
                        <p class="text-gray-600">Usamos solo los mejores ingredientes, sin conservantes, para un sabor 100% real.</p>
                    </div>
                    <div class="flex flex-col items-center">
                        <div class="text-4xl text-white bg-pink-500 rounded-full w-20 h-20 flex items-center justify-center mb-4 shadow-lg"><i class="fas fa-heart"></i></div>
                        <h3 class="text-2xl font-bold mb-2">Hechas con Amor</h3>
                        <p class="text-gray-600">Cada galleta es horneada al momento, con la misma pasi√≥n de una receta familiar.</p>
                    </div>
                    <div class="flex flex-col items-center">
                        <div class="text-4xl text-white bg-amber-500 rounded-full w-20 h-20 flex items-center justify-center mb-4 shadow-lg"><i class="fas fa-shipping-fast"></i></div>
                        <h3 class="text-2xl font-bold mb-2">Delivery R√°pido</h3>
                        <p class="text-gray-600">Recibe tus galletas favoritas calientitas y frescas en la puerta de tu casa.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- ========== PROMOTIONS SECTION ========== -->
        <section id="promociones" class="py-16 md:py-24 bg-white">
             <div class="container mx-auto px-6 scroll-animate">
                <h2 class="font-pacifico text-4xl text-center text-purple-600 mb-12">Promociones del Mes</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 max-w-4xl mx-auto">
                    <!-- Promo 1 -->
                    <div class="bg-white rounded-lg shadow-lg overflow-hidden flex flex-col items-center text-center p-6 border-2 border-amber-400 card-glow transition-shadow duration-300">
                         <div class="text-2xl bg-amber-400 text-white w-16 h-16 rounded-full flex items-center justify-center mb-4 shadow-md"><i class="fas fa-box-open"></i></div>
                        <h3 class="text-2xl font-bold text-gray-800">Caja Amigos</h3>
                        <p class="text-gray-600 mt-2">¬°Lleva 6 galletas de tus sabores favoritos y paga solo 5! Ideal para compartir.</p>
                        <p class="text-3xl font-bold text-purple-600 my-4">$12.50 <span class="text-lg text-gray-400 line-through">$15.00</span></p>
                        <button class="add-promo-btn btn-glow mt-auto bg-purple-600 text-white font-bold py-2 px-6 rounded-full w-full" data-promo="amigos">A√±adir Promo al Carrito</button>
                    </div>
                    <!-- Promo 2 -->
                    <div class="bg-white rounded-lg shadow-lg overflow-hidden flex flex-col items-center text-center p-6 border-2 border-amber-400 card-glow transition-shadow duration-300">
                        <div class="text-2xl bg-amber-400 text-white w-16 h-16 rounded-full flex items-center justify-center mb-4 shadow-md"><i class="fas fa-mug-hot"></i></div>
                        <h3 class="text-2xl font-bold text-gray-800">Combo Tarde Perfecta</h3>
                        <p class="text-gray-600 mt-2">2 galletas a elecci√≥n + 1 bebida caliente (caf√© o chocolate). El plan ideal.</p>
                        <p class="text-3xl font-bold text-purple-600 my-4">$5.00</p>
                        <button class="add-promo-btn btn-glow mt-auto bg-purple-600 text-white font-bold py-2 px-6 rounded-full w-full" data-promo="tarde">A√±adir Promo al Carrito</button>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- ========== PRODUCTS SECTION ========== -->
        <section id="productos" class="py-16 md:py-24 bg-[#FFF7F0]">
            <div class="container mx-auto px-6 scroll-animate">
                <h2 class="font-pacifico text-4xl text-center text-purple-600 mb-12">Nuestro Delicioso Men√∫</h2>
                <div id="product-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <!-- Los productos se insertar√°n aqu√≠ din√°micamente -->
                </div>
            </div>
        </section>

        <!-- ========== COURSES SECTION ========== -->
        <section id="cursos" class="py-16 md:py-24 bg-white">
            <div class="container mx-auto px-6 scroll-animate">
                <h2 class="font-pacifico text-4xl text-center text-purple-600 mb-4">Aprende Nuestros Secretos</h2>
                <p class="text-center text-gray-600 max-w-2xl mx-auto mb-12">Convi√©rtete en un maestro hornero con nuestros cursos exclusivos. ¬°Cupos limitados!</p>
                <div id="course-list" class="grid grid-cols-1 md:grid-cols-2 gap-8 max-w-4xl mx-auto">
                    <!-- Los cursos se insertar√°n aqu√≠ din√°micamente -->
                </div>
            </div>
        </section>


        <!-- ========== TESTIMONIALS (SOCIAL PROOF) ========== -->
        <section class="py-16 md:py-24 bg-[#FFF7F0]">
            <div class="container mx-auto px-6 text-center scroll-animate">
                <h2 class="font-pacifico text-4xl text-purple-600 mb-12">Lo que Dicen Nuestros Clientes</h2>
                 <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <div class="bg-white p-6 rounded-lg shadow-md flex flex-col items-center">
                        <div class="text-yellow-400 text-xl mb-3"><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i></div>
                        <p class="text-gray-600 italic">"¬°Las mejores galletas de Guayaquil, sin duda! La Bomba de Doble Chocolate es de otro mundo. S√∫per frescas y deliciosas."</p>
                        <p class="mt-4 font-bold text-purple-500">- Ana R.</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-md flex flex-col items-center">
                         <div class="text-yellow-400 text-xl mb-3"><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i></div>
                        <p class="text-gray-600 italic">"Excelente servicio y el sabor es incre√≠ble. Se nota que usan ingredientes de calidad. ¬°100% recomendad√≠simo!"</p>
                        <p class="mt-4 font-bold text-purple-500">- Carlos M.</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-md flex flex-col items-center">
                         <div class="text-yellow-400 text-xl mb-3"><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i></div>
                        <p class="text-gray-600 italic">"Ped√≠ una caja para una reuni√≥n y fueron un √©xito total. La Red Velvet Celestial es mi nueva favorita. ¬°Gracias, Choco-Cookies!"</p>
                        <p class="mt-4 font-bold text-purple-500">- Sof√≠a V.</p>
                    </div>
                </div>
            </div>
        </section>

         <!-- ========== FORMULARIO DE INGRESO/SUSCRIPCI√ìN ========== -->
        <section id="contacto" class="py-16 md:py-24 bg-white">
            <div class="container mx-auto px-6 scroll-animate">
                <div class="max-w-xl mx-auto text-center">
                    <h2 class="font-pacifico text-4xl text-purple-600 mb-4">¬°Recibe Ofertas Exclusivas!</h2>
                    <p class="text-gray-700 mb-8">Suscr√≠bete y s√© el primero en enterarte de nuevos sabores y promociones especiales.</p>
                    <form id="subscribe-form" class="flex flex-col sm:flex-row gap-4">
                        <input type="email" id="email-input" placeholder="Tu correo electr√≥nico" required class="w-full px-4 py-3 rounded-md border-gray-300 focus:ring-purple-500 focus:border-purple-500 transition">
                        <button type="submit" class="btn-glow bg-purple-600 text-white font-bold py-3 px-6 rounded-md">Suscribirme</button>
                    </form>
                    <p id="subscribe-feedback" class="mt-4 text-green-600"></p>
                </div>
            </div>
        </section>
    </main>

    <!-- ========== FOOTER ========== -->
    <footer class="bg-gray-800 text-white py-10">
        <div class="container mx-auto px-6 text-center">
            <p class="font-pacifico text-2xl text-purple-400 mb-4">Choco-Cookies</p>
            <div class="flex justify-center space-x-6 mt-6">
                <a href="https://www.instagram.com" target="_blank" class="hover:text-purple-400 transition-colors text-2xl"><i class="fab fa-instagram"></i></a>
                <a href="https://www.facebook.com" target="_blank" class="hover:text-purple-400 transition-colors text-2xl"><i class="fab fa-facebook"></i></a>
                <a href="https://www.tiktok.com" target="_blank" class="hover:text-purple-400 transition-colors text-2xl"><i class="fab fa-tiktok"></i></a>
            </div>
            <p class="text-gray-500 text-sm mt-8">&copy; 2025 Choco-Cookies. Guayaquil, Ecuador.</p>
        </div>
    </footer>

    <!-- ========== CART MODAL ========== -->
    <div id="cart-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex justify-end">
        <div id="cart-sidebar" class="w-full max-w-md bg-white h-full flex flex-col transform translate-x-full transition-transform duration-300">
            <div class="flex justify-between items-center p-5 border-b"><h3 class="text-2xl font-bold text-purple-600">Mi Pedido</h3><button id="close-cart" class="text-gray-500 hover:text-gray-800 text-2xl">&times;</button></div>
            <div id="cart-items" class="flex-grow p-5 overflow-y-auto"><p id="empty-cart-message" class="text-gray-500">Tu carrito est√° vac√≠o.</p></div>
            <div class="p-5 border-t">
                <div class="flex justify-between items-center text-xl font-bold mb-4"><span>Total:</span><span id="cart-total">$0.00</span></div>
                <button id="checkout-button" class="w-full bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-4 rounded-lg flex items-center justify-center space-x-2 transition-colors disabled:bg-gray-300 btn-glow"><i class="fab fa-whatsapp text-2xl"></i><span>Pedir por WhatsApp</span></button>
            </div>
        </div>
    </div>

    <!-- ========== TOAST NOTIFICATION ========== -->
    <div id="toast-container" class="fixed bottom-5 right-5 z-[100] space-y-2"></div>

    <!-- ========== CHATBOT ========== -->
    <div class="fixed bottom-5 left-5 z-[90]">
        <div id="chatbot-window" class="w-80 h-96 bg-white rounded-lg shadow-xl flex flex-col mb-4 transform transition-transform duration-300">
            <div class="bg-purple-600 text-white p-3 rounded-t-lg flex justify-between items-center"><h3 class="font-bold">ChocoBot üç™</h3><p class="text-xs">Tu Vendedor Experto 24/7</p></div>
            <div id="chat-messages" class="flex-1 p-4 overflow-y-auto flex flex-col space-y-2"></div>
            <div id="chat-options" class="p-2 border-t border-gray-200"></div>
        </div>
        <button id="chatbot-toggle" class="bg-purple-600 text-white w-16 h-16 rounded-full shadow-lg flex items-center justify-center transform hover:scale-110 transition-transform">
            <i id="chat-icon-open" class="fas fa-comment-dots text-2xl hidden"></i><i id="chat-icon-close" class="fas fa-times text-2xl"></i>
        </button>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // ----- DATOS -----
            const products = [
                { id: 1, name: "Cl√°sica de Chispas", description: "La receta original que todos aman. Suave, dulce y cargada con chispas de chocolate semiamargo.", price: 2.00, image: "https://images.pexels.com/photos/890507/pexels-photo-890507.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1" },
                { id: 2, name: "Bomba de Doble Chocolate", description: "Para los amantes del cacao. Masa de chocolate oscuro con trozos de chocolate blanco y negro.", price: 2.50, image: "https://images.pexels.com/photos/291528/pexels-photo-291528.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1" },
                { id: 3, name: "Avena Pasi√≥n", description: "Una opci√≥n m√°s saludable pero igual de deliciosa. Avena, canela, y jugosas pasas.", price: 1.75, image: "https://images.pexels.com/photos/2205270/pexels-photo-2205270.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1" },
                { id: 4, name: "Red Velvet Celestial", description: "Suave galleta de red velvet con chispas de chocolate blanco. ¬°Un sabor celestialmente bueno!", price: 2.75, image: "https://images.pexels.com/photos/6061396/pexels-photo-6061396.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1" },
                { id: 5, name: "Fiesta de Macadamia", description: "Un lujo en cada mordida. Galleta de vainilla con trozos de nuez de macadamia y chocolate blanco.", price: 3.00, image: "https://images.pexels.com/photos/2144112/pexels-photo-2144112.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1" }
            ];
            const courses = [
                { id: 101, name: "Secretos de la Galleta Perfecta", description: "Aprende desde cero a hornear galletas con la textura y sabor ideal. Incluye recetario.", price: 45.00, image: "https://images.pexels.com/photos/4491535/pexels-photo-4491535.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1" },
                { id: 102, name: "Decoraci√≥n Creativa de Cookies", description: "Domina el arte del glas√© real y t√©cnicas de decoraci√≥n para crear galletas que enamoran a la vista.", price: 60.00, image: "https://images.pexels.com/photos/7172909/pexels-photo-7172909.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1" }
            ];
            const catalog = [...products, ...courses];
            const whatsappNumber = "593987654321"; // Reemplaza con tu n√∫mero real
            let cart = [];

            const selectors = {
                productList: document.getElementById('product-list'), courseList: document.getElementById('course-list'), cartButton: document.getElementById('cart-button'), cartModal: document.getElementById('cart-modal'), cartSidebar: document.getElementById('cart-sidebar'), closeCart: document.getElementById('close-cart'), cartItems: document.getElementById('cart-items'), cartCount: document.getElementById('cart-count'), cartTotal: document.getElementById('cart-total'), emptyCartMsg: document.getElementById('empty-cart-message'), checkoutButton: document.getElementById('checkout-button'), toastContainer: document.getElementById('toast-container'), subscribeForm: document.getElementById('subscribe-form'), subscribeFeedback: document.getElementById('subscribe-feedback'), chatbotToggle: document.getElementById('chatbot-toggle'), chatbotWindow: document.getElementById('chatbot-window'), chatIconOpen: document.getElementById('chat-icon-open'), chatIconClose: document.getElementById('chat-icon-close'), chatMessages: document.getElementById('chat-messages'), chatOptions: document.getElementById('chat-options'), promoButtons: document.querySelectorAll('.add-promo-btn'),
            };

            // ----- RENDERIZADO INICIAL -----
            function renderProducts() {
                selectors.productList.innerHTML = '';
                products.forEach(product => {
                    const productCard = document.createElement('div');
                    productCard.className = 'bg-white rounded-lg shadow-lg overflow-hidden transform hover:scale-105 transition-all duration-300 flex flex-col card-glow';
                    productCard.innerHTML = `
                        <img src="${product.image}" onerror="this.onerror=null;this.src='https://placehold.co/600x400/a855f7/ffffff?text=Delicia';" alt="[Imagen de ${product.name}]" class="w-full h-56 object-cover">
                        <div class="p-6 flex flex-col flex-grow">
                            <h3 class="text-2xl font-bold text-gray-800">${product.name}</h3>
                            <p class="text-gray-600 mt-2 flex-grow">${product.description}</p>
                            <div class="flex justify-between items-center mt-4">
                                <span class="text-2xl font-bold text-purple-600">$${product.price.toFixed(2)}</span>
                                <button data-id="${product.id}" class="add-to-cart-btn bg-purple-600 text-white font-bold py-2 px-4 rounded-full btn-glow">A√±adir</button>
                            </div>
                        </div>`;
                    selectors.productList.appendChild(productCard);
                });
            }

            function renderCourses() {
                selectors.courseList.innerHTML = '';
                courses.forEach(course => {
                    const courseCard = document.createElement('div');
                    courseCard.className = 'bg-white rounded-lg shadow-lg overflow-hidden flex flex-col items-center text-center p-6 border-2 border-purple-400 card-glow transition-shadow duration-300';
                    courseCard.innerHTML = `
                        <img src="${course.image}" onerror="this.onerror=null;this.src='https://placehold.co/600x400/a855f7/ffffff?text=Curso';" alt="[Imagen de ${course.name}]" class="w-full h-48 object-cover rounded-lg mb-4">
                        <h3 class="text-2xl font-bold text-gray-800">${course.name}</h3>
                        <p class="text-gray-600 mt-2 flex-grow">${course.description}</p>
                        <p class="text-3xl font-bold text-purple-600 my-4">$${course.price.toFixed(2)}</p>
                        <button data-id="${course.id}" class="add-to-cart-btn btn-glow mt-auto bg-purple-600 text-white font-bold py-2 px-6 rounded-full w-full">¬°Me Inscribo!</button>`;
                    selectors.courseList.appendChild(courseCard);
                });
            }

            function showToast(message) {
                const toast = document.createElement('div');
                toast.className = 'toast-enter bg-gray-800 text-white py-2 px-4 rounded-lg shadow-md flex items-center';
                toast.innerHTML = `<i class="fas fa-check-circle text-green-400 mr-2"></i> ${message}`;
                selectors.toastContainer.appendChild(toast);
                setTimeout(() => { toast.classList.remove('toast-enter'); toast.classList.add('toast-exit'); toast.addEventListener('animationend', () => toast.remove()); }, 3000);
            }

            // ----- L√ìGICA DEL CARRITO -----
            function addToCart(itemId, quantity = 1) {
                const item = catalog.find(p => p.id === itemId); if (!item) return;
                const existingItem = cart.find(cartItem => cartItem.id === itemId);
                if (existingItem) existingItem.quantity += quantity; else cart.push({ ...item, quantity });
                return item.name;
            }

            function updateCart() {
                renderCartItems();
                const total = cart.reduce((sum, item) => sum + (item.price || 0) * item.quantity, 0);
                const count = cart.reduce((sum, item) => sum + item.quantity, 0);
                selectors.cartTotal.textContent = `$${total.toFixed(2)}`;
                selectors.cartCount.textContent = count;
                selectors.checkoutButton.disabled = cart.length === 0;
            }

            function renderCartItems() {
                 selectors.cartItems.innerHTML = '';
                if (cart.length === 0) {
                    selectors.cartItems.appendChild(selectors.emptyCartMsg);
                    selectors.emptyCartMsg.classList.remove('hidden');
                } else {
                    selectors.emptyCartMsg.classList.add('hidden');
                    cart.forEach(item => {
                        const cartItem = document.createElement('div');
                        cartItem.className = 'flex justify-between items-center mb-4 cart-item-enter';
                        const itemType = item.id >= 100 ? 'Curso' : 'Galleta'; // Simple way to differentiate
                        cartItem.innerHTML = `
                            <div class="flex items-center space-x-3">
                                <img src="${item.image}" onerror="this.onerror=null;this.src='https://placehold.co/100/a855f7/ffffff?text=üç™';" alt="${item.name}" class="w-16 h-16 object-cover rounded-md">
                                <div><h4 class="font-bold">${item.name}</h4><p class="text-gray-500">$${(item.price || 0).toFixed(2)} x ${item.quantity}</p></div>
                            </div>
                            <button class="remove-item-btn text-red-500 hover:text-red-700 text-xl font-bold" data-id="${item.id}">&times;</button>`;
                        selectors.cartItems.appendChild(cartItem);
                    });
                }
            }
            
            function addPromoToCart(promoType) {
                 if (promoType === 'amigos') {
                    cart = cart.filter(item => !item.promoId);
                    products.slice(0, 5).forEach(p => addToCart(p.id, 1));
                    cart.push({id: 'promo_amigos', name: 'Descuento Caja Amigos', price: -2.50, quantity: 1, image: 'https://placehold.co/100/a855f7/ffffff?text=PROMO', promoId: 'amigos' });
                    showToast("¬°Promo Caja Amigos a√±adida!");
                }
                if (promoType === 'tarde') {
                    cart = cart.filter(item => !item.promoId);
                    cart.push({ id: 'promo_tarde', name: 'Promo Tarde Perfecta', price: 5.00, quantity: 1, image: 'https://placehold.co/100/a855f7/ffffff?text=PROMO', promoId: 'tarde' });
                    showToast("¬°Promo Tarde Perfecta a√±adida!");
                }
                updateCart(); openCart();
            }

            // ----- L√ìGICA DEL CHATBOT VENDEDOR PRO -----
            const chatLogic = {
                main: { message: "¬°Hola! Soy ChocoBot üç™ Tu vendedor experto. ¬øQu√© te trae por aqu√≠ hoy?", options: { "Solo un antojo üòã": "personal_treat", "Busco un regalo üéÅ": "gift_treat", "Quiero ver los cursos üéì": "show_courses", "Tengo otra pregunta ‚ùì": "faq_main" } },
                personal_treat: { message: "¬°Excelente! ¬øTe apetece algo cl√°sico y reconfortante o algo m√°s audaz y chocolatoso?", options: { "Algo cl√°sico": "recommend_classic", "¬°Mucho chocolate!": "recommend_chocolate" } },
                gift_treat: { message: "¬°Un regalo incre√≠ble! Te recomiendo nuestra 'Promo Caja Amigos', quedas como rey/reina. O puedes elegir tus favoritas del men√∫.", options: { "Ver Promo Amigos": "promo_amigos", "Ver el men√∫ completo": "show_all" } },
                recommend_classic: { message: "La 'Cl√°sica de Chispas' nunca falla. Es la galleta perfecta. ¬°Te va a encantar!", product_id: 1, options: { "A√±adir al carrito": { action: "addToCart", id: 1 }, "Ver otra opci√≥n": "personal_treat", "Volver": "main" } },
                recommend_chocolate: { message: "Entonces la 'Bomba de Doble Chocolate' es para ti. ¬°Es una locura de sabor!", product_id: 2, options: { "A√±adir al carrito": { action: "addToCart", id: 2 }, "Ver otra opci√≥n": "personal_treat", "Volver": "main" } },
                show_all: { message: "¬°Claro! Echa un vistazo a nuestro men√∫ completo justo arriba. Si algo te gusta, solo presiona 'A√±adir'. ¬øTe ayudo con algo m√°s?", action: () => { document.getElementById('productos').scrollIntoView({ behavior: 'smooth' }); }, options: { "Ver los cursos": "show_courses", "Listo, quiero pedir": "checkout_guide", "Tengo una pregunta": "faq_main" } },
                show_courses: { message: "¬°Genial! Nuestros cursos son incre√≠bles. Puedes verlos en su secci√≥n. ¬°Te convertir√°s en un experto!", action: () => { document.getElementById('cursos').scrollIntoView({ behavior: 'smooth' }); }, options: { "Ver el men√∫ de galletas": "show_all", "Listo, quiero pedir": "checkout_guide" } },
                promo_amigos: { message: "La 'Caja Amigos' lleva 6 galletas y pagas 5. ¬°Es genial! ¬øLa a√±adimos al carrito?", options: { "S√≠, a√±adir promo": { action: "addPromo", type: "amigos" }, "No, gracias": "main" } },
                added_to_cart: { message: "¬°Listo! Ya est√° en tu carrito. ¬øQuieres finalizar tu compra o seguimos explorando?", options: { "Finalizar compra üõí": "checkout_guide", "Ver men√∫ de galletas": "show_all", "Ver cursos": "show_courses" } },
                checkout_guide: { message: "¬°Perfecto! Para completar tu pedido, solo haz clic en el carrito üõí arriba a la derecha y luego en el bot√≥n verde de WhatsApp. ¬°As√≠ de f√°cil!", action: () => { openCart() }, options: { "¬°Gracias, ChocoBot!": "main" } },
                faq_main: { message: "¬øClaro, cu√°l es tu duda?", options: { "üõµ Env√≠os": "faq_delivery", "üïí Horarios": "faq_hours", "Volver": "main" } },
                faq_delivery: { message: "Hacemos entregas en todo Guayaquil. El costo y tiempo var√≠an seg√∫n la zona.", options: { "Tengo otra pregunta": "faq_main", "Volver": "main" } },
                faq_hours: { message: "Nuestro horario es de Lunes a S√°bado, de 9 AM a 7 PM.", options: { "Tengo otra pregunta": "faq_main", "Volver": "main" } }
            };

            let isChatbotOpen = true;

            function openChatbot() {
                selectors.chatbotWindow.classList.remove('scale-95', 'opacity-0', 'translate-y-full');
                selectors.chatIconOpen.classList.add('hidden');
                selectors.chatIconClose.classList.remove('hidden');
                isChatbotOpen = true;
            }

            function closeChatbot() {
                selectors.chatbotWindow.classList.add('scale-95', 'opacity-0', 'translate-y-full');
                selectors.chatIconOpen.classList.remove('hidden');
                selectors.chatIconClose.classList.add('hidden');
                isChatbotOpen = false;
            }

            function chatbotSend(stateKey) { const state = chatLogic[stateKey]; if (state.action) state.action(); addBotMessage(state.message); if (state.product_id) renderProductInChat(state.product_id); showChatOptions(state.options); }
            function addBotMessage(text) { const msgDiv = document.createElement('div'); msgDiv.className = 'chat-bubble chat-bubble-bot p-3 self-start'; msgDiv.textContent = text; selectors.chatMessages.appendChild(msgDiv); selectors.chatMessages.scrollTop = selectors.chatMessages.scrollHeight; }
            function renderProductInChat(productId) { const product = catalog.find(p => p.id === productId); if (!product) return; const productDiv = document.createElement('div'); productDiv.className = 'p-2 my-2 bg-white rounded-lg flex items-center gap-3 self-start border'; productDiv.innerHTML = `<img src="${product.image}" class="w-12 h-12 rounded-md object-cover"> <div><p class="font-bold text-sm">${product.name}</p><p class="text-xs text-purple-600 font-semibold">$${product.price.toFixed(2)}</p></div>`; selectors.chatMessages.appendChild(productDiv); }
            function showChatOptions(options) { selectors.chatOptions.innerHTML = ''; for (const [text, value] of Object.entries(options)) { const button = document.createElement('button'); button.className = 'w-full text-left text-sm text-purple-600 bg-purple-100 hover:bg-purple-200 rounded-lg p-2 mb-1 transition-colors'; button.textContent = text; if (typeof value === 'string') { button.dataset.key = value; } else if (typeof value === 'object') { button.dataset.action = value.action; if(value.id) button.dataset.id = value.id; if(value.type) button.dataset.type = value.type; } button.onclick = (e) => handleUserChoice(e.currentTarget); selectors.chatOptions.appendChild(button); } }
            function handleUserChoice(button) { const userMsgDiv = document.createElement('div'); userMsgDiv.className = 'chat-bubble chat-bubble-user p-3 self-end'; userMsgDiv.textContent = button.textContent; selectors.chatMessages.appendChild(userMsgDiv); selectors.chatMessages.scrollTop = selectors.chatMessages.scrollHeight; const { key, action, id, type } = button.dataset; setTimeout(() => { if (action === 'addToCart') { addToCart(parseInt(id)); updateCart(); chatbotSend('added_to_cart'); } else if (action === 'addPromo') { addPromoToCart(type); chatbotSend('added_to_cart'); } else { chatbotSend(key); } }, 500); }
            
            // ----- ANIMACI√ìN SCROLL -----
            const observer = new IntersectionObserver((entries) => { entries.forEach(entry => { if (entry.isIntersecting) entry.target.classList.add('is-visible'); }); }, { threshold: 0.1 });
            document.querySelectorAll('.scroll-animate').forEach(el => observer.observe(el));

            // ----- EVENTOS -----
            function openCart() { selectors.cartModal.classList.remove('hidden'); setTimeout(() => selectors.cartSidebar.classList.remove('translate-x-full'), 10); }
            function closeCart() { selectors.cartSidebar.classList.add('translate-x-full'); setTimeout(() => selectors.cartModal.classList.add('hidden'), 300); }
            document.body.addEventListener('click', (e) => { if (e.target.matches('.add-to-cart-btn')) { const name = addToCart(parseInt(e.target.dataset.id)); showToast(`¬°A√±adiste ${name}!`); updateCart(); } });
            selectors.cartItems.addEventListener('click', (e) => { if (e.target.matches('.remove-item-btn')) { const id = e.target.dataset.id; const item = cart.find(i => i.id == id); if (item && item.promoId) { cart = cart.filter(i => i.promoId !== item.promoId); } else { cart = cart.filter(i => i.id != id); } updateCart(); } });
            selectors.promoButtons.forEach(btn => btn.addEventListener('click', () => addPromoToCart(btn.dataset.promo)));
            selectors.cartButton.addEventListener('click', openCart);
            selectors.closeCart.addEventListener('click', closeCart);
            selectors.cartModal.addEventListener('click', (e) => { if (e.target === selectors.cartModal) closeCart(); });
            selectors.checkoutButton.addEventListener('click', () => { if (cart.length === 0) return; let message = "¬°Hola Choco-Cookies! üëãüç™\n\nQuisiera hacer el siguiente pedido:\n\n"; const total = cart.reduce((sum, item) => sum + (item.price || 0) * item.quantity, 0); cart.forEach(item => { const itemType = item.id >= 100 ? 'CURSO' : `${item.quantity}x`; message += `*${itemType}* - ${item.name} ($${((item.price || 0) * item.quantity).toFixed(2)})\n`; }); message += `\n*Total a pagar: $${total.toFixed(2)}*\n\n¬°Muchas gracias!`; window.open(`https://wa.me/${whatsappNumber}?text=${encodeURIComponent(message)}`, '_blank'); });
            selectors.subscribeForm.addEventListener('submit', (e) => { e.preventDefault(); selectors.subscribeFeedback.textContent = `¬°Gracias por suscribirte!`; e.target.reset(); setTimeout(() => selectors.subscribeFeedback.textContent = '', 4000); });
            
            selectors.chatbotToggle.addEventListener('click', () => { isChatbotOpen ? closeChatbot() : openChatbot(); });
            
            document.addEventListener('click', (e) => {
                if (!isChatbotOpen) return;
                const isClickInsideChat = selectors.chatbotWindow.contains(e.target);
                const isClickOnToggle = selectors.chatbotToggle.contains(e.target);
                if (!isClickInsideChat && !isClickOnToggle) {
                    closeChatbot();
                }
            });

            // ----- INICIALIZACI√ìN -----
            renderProducts();
            renderCourses();
            updateCart();
            chatbotSend('main');
            // Chatbot starts open by default.
            // We adjust the initial classes in the HTML for this.
        });
    </script>

</body>
</html>

