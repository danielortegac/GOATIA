<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>D'CORE - Un Legado de Detalles del Corazón</title>
    <link rel="icon" href="./logo-dcore.jpg" type="image/x-icon">
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <!-- Swiper.js for Carousels -->
    <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css" />
    <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Paleta de Colores Vibrante */
        :root {
            --bg-light: #FFFAF5; 
            --text-dark: #402A24; 
            --primary-red: #E63946;
            --accent-orange: #F4A261; 
            --accent-green: #2A9D8F; 
            --highlight-yellow: #E9C46A;
        }

        html { scroll-behavior: smooth; }
        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--bg-light);
            color: var(--text-dark);
            overflow-x: hidden;
        }
        h1, h2, h3 { font-family: 'Playfair Display', serif; }
        
        .btn-primary {
            background-color: var(--primary-red);
            color: white;
            padding: 0.85rem 2.5rem;
            border-radius: 9999px;
            font-weight: 700;
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            box-shadow: 0 4px 15px rgba(230, 57, 70, 0.3);
            transform: translateY(0);
        }
        .btn-primary:hover {
            background-color: #c42d38;
            box-shadow: 0 8px 25px rgba(230, 57, 70, 0.4);
            transform: translateY(-4px);
        }
        
        @keyframes gradient-flow { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
        .animate-gradient-flow { background: linear-gradient(-45deg, var(--primary-red), var(--accent-orange), var(--highlight-yellow), var(--primary-red)); background-size: 400% 400%; color: transparent; background-clip: text; -webkit-background-clip: text; animation: gradient-flow 10s ease infinite; }
        
        .fade-in-up { opacity: 0; transform: translateY(40px); transition: opacity 0.8s ease-out, transform 0.8s ease-out; }
        .in-view { opacity: 1; transform: translateY(0); }

        .product-card { background-color: #fff; border-radius: 1rem; box-shadow: 0 10px 15px rgba(0, 0, 0, 0.05); transition: transform 0.4s ease, box-shadow 0.4s ease; overflow: hidden; position: relative; }
        .product-card:hover { transform: translateY(-10px); box-shadow: 0 20px 30px rgba(0, 0, 0, 0.1); }
        .sale-badge { position: absolute; top: 1rem; left: -10px; background-color: var(--primary-red); color: white; padding: 0.35rem 1rem; border-radius: 3px; font-size: 0.9rem; font-weight: bold; transform: rotate(-5deg); box-shadow: 2px 2px 5px rgba(0,0,0,0.2); }
        .hero-swiper .swiper-slide img { width: 100%; height: 60vh; object-fit: cover; border-radius: 1.5rem; }
        .swiper-pagination-bullet-active { background: var(--primary-red) !important; }

        .story-highlight { font-weight: 700; background: linear-gradient(180deg, transparent 65%, var(--accent-orange) 65%); }

        /* Calendario Mejorado y Responsivo */
        #calendar { display: grid; grid-template-columns: repeat(7, 1fr); gap: 4px; }
        .calendar-day { padding: 4px; font-size: 0.8rem; aspect-ratio: 1/1; display:flex; align-items:center; justify-content:center; text-align: center; border-radius: 50%; transition: all 0.2s ease; position: relative; cursor: pointer; color: var(--text-dark); }
        .calendar-day:not(.empty):hover { background-color: #f0f0f0; }
        .calendar-day.has-event::after { content: ''; position: absolute; bottom: 4px; left: 50%; transform: translateX(-50%); width: 5px; height: 5px; border-radius: 50%; background-color: var(--primary-red); }
        .calendar-day.today { background-color: var(--highlight-yellow); color: var(--text-dark); font-weight: 700; }
        .calendar-day.user-event { background-color: var(--accent-green); color: white; }
        .calendar-day.user-event::after { background-color: white; }
        @media (max-width: 640px) { .calendar-day { padding: 2px; font-size: 0.7rem; } }
        
        #info-modal-overlay { position: fixed; inset: 0; background-color: rgba(0,0,0,0.5); backdrop-filter: blur(4px); z-index: 2000; opacity: 0; transition: opacity 0.3s ease; pointer-events: none; }
        #info-modal-overlay.open { opacity: 1; pointer-events: auto; }
        #info-modal { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0.95); opacity: 0; transition: all 0.3s ease; }
        #info-modal-overlay.open #info-modal { transform: translate(-50%, -50%) scale(1); opacity: 1; }

        /* Taller Card Rediseño */
        .workshop-card { background-color: white; border-radius: 1.5rem; box-shadow: 0 10px 30px rgba(0,0,0,0.07); transition: all 0.3s ease; display: flex; flex-direction: column; }
        .workshop-card:hover { transform: translateY(-10px) scale(1.02); box-shadow: 0 20px 40px rgba(0,0,0,0.1); }
        .workshop-card ul { list-style-position: inside; }
        .workshop-card ul li { background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="%232A9D8F" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>') no-repeat left center; padding-left: 24px; margin-bottom: 0.5rem; }

        /* Chatbot Premium Design */
        @keyframes subtle-pulse { 0%, 100% { transform: scale(1); box-shadow: 0 5px 20px rgba(42, 157, 143, 0.2); } 50% { transform: scale(1.05); box-shadow: 0 8px 30px rgba(42, 157, 143, 0.3); } }
        #chat-widget { position: fixed; bottom: 25px; right: 25px; z-index: 1000; }
        #chat-button { background-color: var(--accent-green); color: white; width: 65px; height: 65px; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: transform 0.3s ease; animation: subtle-pulse 2.5s infinite ease-in-out; font-size: 2rem; }
        #chat-button.open { animation: none; transform: scale(0.9); }
        #chat-overlay { position: fixed; inset: 0; background-color: rgba(0,0,0,0.3); backdrop-filter: blur(2px); z-index: 998; opacity: 0; transition: opacity 0.3s ease; pointer-events: none; }
        #chat-overlay.open { opacity: 1; pointer-events: auto; }
        #chat-window { position: fixed; bottom: 100px; right: 25px; width: 90vw; max-width: 380px; height: 75vh; max-height: 600px; background-color: #f4f7f9; border-radius: 20px; box-shadow: 0 10px 40px rgba(0,0,0,0.15); display: flex; flex-direction: column; transform: scale(0.95) translateY(20px); opacity: 0; transition: all 0.3s ease-in-out; pointer-events: none; z-index: 999; }
        #chat-window.open { transform: scale(1) translateY(0); opacity: 1; pointer-events: auto; }
        @media (max-width: 640px) { #chat-window.open { bottom: 25px; right: 5vw; } }
        .chat-header { background: linear-gradient(135deg, var(--accent-green), #258a7e); border-bottom: 1px solid rgba(0,0,0,0.05); }
        .chat-body { padding: 1.25rem; }
        .chat-message-container { display: flex; gap: 10px; max-width: 90%; margin-bottom: 1rem; }
        .bot-avatar { width: 40px; height: 40px; border-radius: 50%; background-color: #e0e0e0; flex-shrink: 0; border: 2px solid white; box-shadow: 0 2px 5px rgba(0,0,0,0.1); display: flex; align-items: center; justify-content: center; font-size: 1.5rem; }
        .chat-message { padding: 12px 18px; border-radius: 18px; line-height: 1.5; animation: pop-in 0.3s cubic-bezier(0.25, 0.8, 0.25, 1); }
        @keyframes pop-in { from { transform: scale(0.8) translateY(10px); opacity: 0; } to { transform: scale(1) translateY(0); opacity: 1; } }
        .user-message-container { align-self: flex-end; }
        .bot-message-container { align-self: flex-start; }
        .user-message .chat-message { background-color: var(--accent-orange); color: var(--text-dark); border-bottom-right-radius: 4px; }
        .bot-message .chat-message { background-color: #fff; color: var(--text-dark); border-bottom-left-radius: 4px; box-shadow: 0 4px 10px rgba(0,0,0,0.05); }
        .chat-options { display: flex; flex-wrap: wrap; justify-content: flex-start; padding-top: 5px; margin-left: 50px; }
        .chat-options button { background-color: transparent; border: 1px solid var(--accent-green); color: var(--accent-green); padding: 8px 14px; border-radius: 20px; font-size: 0.85rem; transition: all 0.2s ease; margin: 4px; cursor: pointer; font-weight: 600; }
        .chat-options button:hover { background-color: var(--accent-green); color: white; transform: translateY(-2px); box-shadow: 0 4px 10px rgba(42, 157, 143, 0.2); }
        .typing-indicator span { display: inline-block; width: 8px; height: 8px; border-radius: 50%; background-color: #aaa; margin: 0 2px; animation: bounce 1s infinite; }
        .typing-indicator span:nth-child(2) { animation-delay: 0.2s; } .typing-indicator span:nth-child(3) { animation-delay: 0.4s; }
        @keyframes bounce { 0%, 80%, 100% { transform: scale(0); } 40% { transform: scale(1); } }
        #chat-form { border-top: 1px solid #e5e7eb; }

    </style>
</head>
<body class="antialiased">

    <!-- Header & Navigation (Original Structure) -->
    <header class="sticky top-0 z-50 bg-white/80 backdrop-blur-lg shadow-sm transition-all duration-300 py-4">
        <div class="container mx-auto px-6 flex justify-between items-center">
            <a href="#inicio" class="flex items-center space-x-3">
                <img src="./logo-dcore.jpg" alt="D'CORE Logo" class="w-12 h-12 rounded-full border-2" style="border-color: var(--accent-orange);">
                <span class="text-3xl font-bold tracking-wider" style="font-family: 'Playfair Display', serif;">D'CORE</span>
            </a>
            <nav class="hidden md:flex items-center space-x-8 text-lg">
                <a href="#nosotros" class="hover:text-red-500 transition-colors duration-300">Nuestra Historia</a>
                <a href="#promociones" class="hover:text-red-500 transition-colors duration-300">Promociones</a>
                <a href="#talleres" class="hover:text-red-500 transition-colors duration-300">Talleres</a>
                <a href="#productos" class="hover:text-red-500 transition-colors duration-300">Productos</a>
                <a href="#pagos" class="hover:text-red-500 transition-colors duration-300">Pagos</a>
                <a href="#contacto" class="hover:text-red-500 transition-colors duration-300">Contacto</a>
            </nav>
            <div class="flex items-center space-x-4">
                <button id="cart-btn" class="relative group">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-gray-700 group-hover:text-red-500 transition-all" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.182 1.944.693 1.944H17.5a2.25 2.25 0 002-2.25v-2.25" /></svg>
                    <span id="cart-count" class="absolute top-[-0.5rem] right-[-0.5rem] bg-red-500 text-white text-xs font-bold w-5 h-5 rounded-full flex items-center justify-center hidden">0</span>
                </button>
            </div>
        </div>
    </header>

    <!-- Cart Modal (Original Structure) -->
    <div id="cart-modal" class="fixed top-0 right-0 h-full w-full md:w-96 bg-white shadow-2xl z-[100] p-6 flex flex-col transform translate-x-full transition-transform duration-500 ease-in-out">
        <div class="flex justify-between items-center mb-6"><h2 class="text-3xl font-bold">Tu Carrito</h2><button id="close-cart-btn" class="text-4xl hover:text-red-500 transition-colors">&times;</button></div><div id="cart-items" class="flex-1 overflow-y-auto space-y-4 pr-2"></div><div id="cart-summary" class="mt-6 pt-4 border-t border-gray-200"><div class="flex justify-between items-center text-xl font-bold mb-4"><span>Total:</span><span id="cart-total">$0.00</span></div><button id="whatsapp-btn" class="btn-primary w-full text-center">Enviar Carrito por WhatsApp</button></div>
    </div>

    <main>
        <!-- Hero Section (Original Structure) -->
        <section id="inicio" class="container mx-auto px-6 py-12">
            <div class="swiper hero-swiper shadow-xl rounded-2xl">
                <div class="swiper-wrapper" id="hero-carousel-wrapper"></div>
                <div class="swiper-pagination"></div>
            </div>
            <div class="text-center mt-12">
                <h1 class="text-6xl md:text-8xl font-black mb-4 animate-gradient-flow">D'CORE</h1>
                <p class="text-2xl md:text-3xl font-light text-gray-700" style="font-family: 'Playfair Display', serif;">Un Legado de Detalles del Corazón</p>
                <a href="#productos" class="mt-8 inline-block btn-primary">Explorar Colección</a>
            </div>
        </section>

        <!-- Our Story Section (Original Structure) -->
        <section id="nosotros" class="container mx-auto px-6 py-20 fade-in-up">
            <h2 class="text-4xl md:text-5xl font-bold text-center mb-12">Nuestra Historia</h2>
            <div class="flex flex-col md:flex-row items-center gap-12">
                <div class="md:w-1/2">
                    <img src="./IMG-20250830-WA0037.jpg" alt="Foto de la familia D'CORE" class="w-full h-auto rounded-xl shadow-lg transform rotate-2 transition-transform duration-500 hover:rotate-0">
                </div>
                <div class="md:w-1/2 text-lg leading-relaxed">
                    <p class="mb-4">La historia de D'CORE no empezó en un bazar, sino en intercambios de nueve hermanos. Pepe, Alba, Marco, Paty, Lenin, Lupe, Kathy, Cubi y Marie crecieron en un hogar donde los regalos <strong class="story-highlight">no se compraban, se creaban</strong>. Cada cumpleaños, cada Navidad, el verdadero desafío era <strong class="story-highlight">superar la creatividad</strong> del año anterior.</p>
                    <p class="mb-4">El incidente detonante ocurrió cuando un amigo de la familia, conmovido por un obsequio, dijo: “Tu regalo tiene un <strong class="story-highlight">valor que el dinero no puede comprar</strong>”. Esa simple frase encendió una chispa en los hermanos.</p>
                    <p>Así, lo que empezó como una tradición familiar se transformó en una misión: <strong class="story-highlight">unir sus talentos y crear D'CORE</strong>, un lugar donde cada detalle sale del corazón.</p>
                </div>
            </div>
        </section>

        <!-- Promotions Section with Countdown -->
        <section id="promociones" class="py-20">
             <div class="container mx-auto px-6">
                <div class="max-w-4xl mx-auto bg-white rounded-2xl p-8 md:p-12 text-center fade-in-up shadow-xl border-2 border-dashed" style="border-color: var(--accent-orange);">
                    <h3 class="text-3xl font-bold mb-3" style="color: var(--primary-red);">¡OFERTA DE SEPTIEMBRE!</h3>
                    <h2 class="text-4xl md:text-5xl font-bold text-center mb-4">Amor y Amistad</h2>
                    <p class="text-xl text-gray-800 mb-8">Recibe un <strong>15% de DESCUENTO</strong> en todos los productos de <strong>tejido y bordado</strong>. ¡El detalle perfecto para esa persona especial está esperando!</p>
                    <div id="countdown" class="flex justify-center gap-4 md:gap-8 my-8 text-gray-800"><div><span id="days" class="text-4xl md:text-5xl font-bold">00</span><p class="text-sm">Días</p></div><div><span id="hours" class="text-4xl md:text-5xl font-bold">00</span><p class="text-sm">Horas</p></div><div><span id="minutes" class="text-4xl md:text-5xl font-bold">00</span><p class="text-sm">Minutos</p></div><div><span id="seconds" class="text-4xl md:text-5xl font-bold">00</span><p class="text-sm">Segundos</p></div></div>
                    <a href="#productos" class="btn-primary inline-block">Ver Productos en Oferta</a>
                </div>
            </div>
        </section>

        <!-- NEW Promotion Section -->
        <section id="promo-talleres" class="py-20">
            <div class="container mx-auto px-6">
                <div class="max-w-4xl mx-auto bg-gradient-to-br from-green-50 to-yellow-50 rounded-2xl p-8 md:p-12 text-center fade-in-up shadow-lg border-2 border-green-200 border-dashed">
                    <h3 class="text-3xl font-bold mb-3" style="color: var(--accent-green);">¡PROMO 2x1: APRENDE Y CREA!</h3>
                    <h2 class="text-4xl md:text-5xl font-bold text-center mb-6">Inscríbete y Recibe un Regalo</h2>
                    <p class="text-lg md:text-xl text-gray-800 mb-8">Al inscribirte en cualquiera de nuestros talleres este mes, te llevas un <strong>llavero de madera grabado</strong> con tu inicial, ¡totalmente <strong>GRATIS</strong>!</p>
                    <a href="#talleres" class="btn-primary inline-block" style="background-color: var(--accent-green);">Ver Talleres Disponibles</a>
                </div>
            </div>
        </section>


        <!-- Talleres Section -->
        <section id="talleres" class="py-20 bg-green-50">
            <div class="container mx-auto px-6 text-center">
                <h2 class="text-4xl md:text-5xl font-bold mb-4 fade-in-up">Crea con Tus Propias Manos</h2>
                <p class="max-w-3xl mx-auto text-lg text-gray-600 mb-12 fade-in-up">Rescatamos la belleza de lo artesanal. Únase a nuestros talleres y aprenda a crear regalos inolvidables, una experiencia perfecta para compartir o para reconectar con su lado creativo.</p>
                <div class="grid grid-cols-2 lg:grid-cols-4 gap-8">
                    <div class="workshop-card p-6 text-left fade-in-up" style="transition-delay: 100ms;"><h3 class="text-2xl font-bold mb-2 text-center">Taller de Amigurumi</h3><div class="text-center mb-4"><span class="font-bold text-lg text-green-600">$45.00</span><span class="text-gray-500"> / persona</span></div><p class="text-gray-600 mb-4 flex-grow text-sm">Aprenda desde cero a tejer muñecos adorables. Ideal para principiantes.</p><ul class="text-sm text-gray-700 mt-auto"><li>Materiales incluidos</li><li>4 sesiones de 2h</li><li>Proyecto final guiado</li></ul><a href="https://wa.me/593987786632?text=Hola%20D'CORE,%20deseo%20más%20información%20del%20Taller%20de%20Amigurumi." target="_blank" class="btn-primary mt-6 w-full text-center text-sm">Más Detalles</a></div>
                    <div class="workshop-card p-6 text-left fade-in-up" style="transition-delay: 200ms;"><h3 class="text-2xl font-bold mb-2 text-center">Bordado para Parejas</h3><div class="text-center mb-4"><span class="font-bold text-lg text-green-600">$60.00</span><span class="text-gray-500"> / pareja</span></div><p class="text-gray-600 mb-4 flex-grow text-sm">Una cita terapéutica y creativa para fortalecer su conexión bordando un diseño que represente su unión.</p><ul class="text-sm text-gray-700 mt-auto"><li>Ambiente relajante</li><li>Todos los materiales</li><li>1 sesión intensiva de 3h</li></ul><a href="https://wa.me/593987786632?text=Hola%20D'CORE,%20deseamos%20información%20del%20Taller%20de%20Bordado%20para%20Parejas." target="_blank" class="btn-primary mt-6 w-full text-center text-sm">Reservar Cita</a></div>
                    <div class="workshop-card p-6 text-left fade-in-up" style="transition-delay: 300ms;"><h3 class="text-2xl font-bold mb-2 text-center">Taller de Carpintería</h3><div class="text-center mb-4"><span class="font-bold text-lg text-green-600">$75.00</span><span class="text-gray-500"> / persona</span></div><p class="text-gray-600 mb-4 flex-grow text-sm">Cree un objeto decorativo de madera, desde tablas de picar personalizadas hasta pequeños organizadores.</p><ul class="text-sm text-gray-700 mt-auto"><li>Maderas nobles</li><li>Uso de herramientas</li><li>Acabados profesionales</li></ul><a href="https://wa.me/593987786632?text=Hola%20D'CORE,%20deseo%20información%20del%20Taller%20de%20Carpintería." target="_blank" class="btn-primary mt-6 w-full text-center text-sm">Consultar Fechas</a></div>
                    <div class="workshop-card p-6 text-left fade-in-up" style="transition-delay: 400ms;"><h3 class="text-2xl font-bold mb-2 text-center">Asesoría 1-a-1</h3><div class="text-center mb-4"><span class="font-bold text-lg text-green-600">$25.00</span><span class="text-gray-500"> / hora</span></div><p class="text-gray-600 mb-4 flex-grow text-sm">¿Atascado en un proyecto? Le ayudamos a resolver dudas y a perfeccionar su técnica de tejido, bordado o madera.</p><ul class="text-sm text-gray-700 mt-auto"><li>Atención personalizada</li><li>Resolución de dudas</li><li>Técnicas avanzadas</li></ul><a href="https://wa.me/593987786632?text=Hola%20D'CORE,%20quisiera%20agendar%20una%20Asesoría%201-a-1." target="_blank" class="btn-primary mt-6 w-full text-center text-sm">Agendar Ahora</a></div>
                </div>
            </div>
        </section>

        <!-- NEW Muebles a Medida Section -->
        <section id="muebles-medida" class="py-20">
            <div class="container mx-auto px-6">
                <div class="flex flex-col md:flex-row items-center gap-12 bg-white rounded-2xl shadow-lg p-8 md:p-12 fade-in-up">
                    <div class="md:w-1/2 text-center md:text-left">
                        <h3 class="text-2xl font-bold" style="color: var(--accent-orange);">NUEVO SERVICIO PREMIUM</h3>
                        <h2 class="text-4xl md:text-5xl font-bold mt-2 mb-6">Muebles a la Medida</h2>
                        <p class="text-lg text-gray-700 mb-6 leading-relaxed">Transformamos sus ideas en piezas de mobiliario únicas. Creamos anaqueles, muebles de cocina, repisas flotantes, centros de entretenimiento y más, con la misma dedicación y calidad que nos caracteriza. Llevamos el corazón de D'CORE a cada rincón de su hogar.</p>
                        <a href="https://wa.me/593987786632?text=Hola%20D'CORE,%20me%20gustaría%20cotizar%20un%20mueble%20a%20la%20medida." target="_blank" class="btn-primary">Cotizar Mi Proyecto</a>
                    </div>
                    <div class="md:w-1/2">
                        <img src="https://images.unsplash.com/photo-1592078615290-033ee584e267?q=80&w=2160&auto=format&fit=crop" alt="Silla de madera de diseño" class="w-full h-auto rounded-xl shadow-md">
                    </div>
                </div>
            </div>
        </section>


        <!-- Calendar Service Section -->
        <section id="reminder-service" class="py-20" style="background-color: var(--accent-green); background-image: linear-gradient(135deg, var(--accent-green) 0%, #258a7e 100%);">
            <div class="container mx-auto px-6 fade-in-up">
                <div class="text-center mb-12 text-white">
                    <h2 class="text-4xl md:text-5xl font-bold mb-4 flex items-center justify-center gap-3">El Guardián de Fechas <button id="info-btn" class="text-2xl bg-white/20 rounded-full w-8 h-8 flex items-center justify-center transition-transform hover:scale-110">i</button></h2>
                    <p class="max-w-3xl mx-auto text-lg text-green-100">¡No vuelva a olvidar una fecha importante! Revise nuestro calendario de celebraciones y agende sus recordatorios personales.</p>
                </div>
                <div class="max-w-6xl mx-auto grid lg:grid-cols-5 gap-8 items-start">
                    <div class="lg:col-span-3 bg-white p-4 sm:p-6 rounded-2xl shadow-lg">
                        <div id="calendar-header" class="flex justify-between items-center mb-4"><button id="prev-month" class="p-2 rounded-full hover:bg-gray-100">&lt;</button><h3 id="month-year" class="text-xl font-bold text-center"></h3><button id="next-month" class="p-2 rounded-full hover:bg-gray-100">&gt;</button></div>
                        <div id="calendar-weekdays" class="grid grid-cols-7 gap-2 text-center font-semibold text-gray-500 text-xs sm:text-sm mb-2"><div>D</div><div>L</div><div>M</div><div>M</div><div>J</div><div>V</div><div>S</div></div>
                        <div id="calendar"></div>
                    </div>
                    <div class="lg:col-span-2 grid grid-cols-2 gap-6 lg:block lg:space-y-6">
                        <div class="bg-white/90 backdrop-blur-sm p-6 rounded-2xl shadow-lg">
                            <h3 class="text-xl font-bold mb-3">Fechas de <span id="events-month"></span></h3>
                            <ul id="events-list" class="space-y-2 text-gray-700 h-24 overflow-y-auto pr-2 text-sm"><li>Cargando...</li></ul>
                        </div>
                        <div class="bg-white/90 backdrop-blur-sm p-6 rounded-2xl shadow-lg">
                            <h3 class="text-xl font-bold mb-3">Agende su Fecha</h3>
                            <form id="date-form" class="flex flex-col gap-3">
                                <input type="text" id="event-name" placeholder="Ej: Aniversario" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-400 text-sm" required>
                                <input type="date" id="event-date" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-400 text-sm" required>
                                <button type="submit" class="btn-primary text-sm py-2">¡Agendar y Recordar!</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Product Gallery Section (Original Structure) -->
        <section id="productos" class="py-20 my-12">
            <div class="container mx-auto px-6">
                <h2 class="text-4xl md:text-5xl font-bold text-center mb-12 fade-in-up">Nuestras Creaciones</h2>
                <div id="product-grid" class="grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 md:gap-8"></div>
            </div>
        </section>

        <!-- Testimonials Section (Original Structure) -->
        <section id="testimonials" class="container mx-auto px-6 py-20">
            <h2 class="text-4xl md:text-5xl font-bold text-center mb-12 fade-in-up">Lo que dicen Nuestros Clientes</h2>
            <div class="swiper testimonials-swiper max-w-3xl mx-auto fade-in-up">
                <div class="swiper-wrapper" id="testimonials-wrapper"></div>
                <div class="swiper-pagination mt-8"></div>
            </div>
        </section>

        <!-- Call to Action Section (Original Structure) -->
        <section id="contacto" class="container mx-auto px-6 py-20 text-center">
             <div class="bg-gradient-to-tr from-gray-800 to-gray-900 rounded-3xl shadow-xl p-8 md:p-16 fade-in-up">
                <h2 class="text-4xl md:text-5xl font-bold mb-4 text-white">¿Tiene una idea? La hacemos realidad.</h2>
                <p class="text-lg md:text-xl mb-10 max-w-3xl mx-auto text-gray-300">Su imaginación es el único límite. Realizamos personajes de cualquier serie, película o videojuego. Envíenos su inspiración y nuestro equipo de artesanos la transformará en una pieza de arte tangible y exclusiva para usted.</p>
                <a href="https://wa.me/593987786632?text=Hola%20D'CORE,%20me%20gustaría%20cotizar%20un%20regalo%20personalizado." target="_blank" class="btn-primary">Cotice su Idea Aquí</a>
             </div>
        </section>

        <!-- NEW Payment Methods Section -->
        <section id="pagos" class="container mx-auto px-6 py-20 fade-in-up">
            <div class="max-w-5xl mx-auto">
                <h2 class="text-4xl md:text-5xl font-bold text-center mb-6">Métodos de Pago</h2>
                <p class="text-center text-lg text-gray-600 mb-12">Hacemos que el proceso para obtener su detalle sea fácil y seguro.</p>
                
                <div class="bg-white rounded-2xl shadow-lg p-8 md:p-12">
                    <h3 class="text-3xl font-bold mb-8 text-center" style="color: var(--text-dark);">Proceso de Compra Sencillo</h3>
                    
                    <!-- Mobile View: Compact Grid with text -->
                    <div class="grid grid-cols-2 gap-x-4 gap-y-8 text-center md:hidden">
                        <div class="flex flex-col items-center">
                            <span class="flex items-center justify-center w-12 h-12 bg-green-200 rounded-full ring-4 ring-white font-bold text-green-700 text-lg">1</span>
                            <h4 class="font-bold text-sm mt-2 mb-1">Elige tu Producto</h4>
                            <p class="text-xs text-gray-600">Navega y añade tus favoritos al carrito.</p>
                        </div>
                        <div class="flex flex-col items-center">
                            <span class="flex items-center justify-center w-12 h-12 bg-green-200 rounded-full ring-4 ring-white font-bold text-green-700 text-lg">2</span>
                            <h4 class="font-bold text-sm mt-2 mb-1">Confirma por WhatsApp</h4>
                            <p class="text-xs text-gray-600">Envíanos tu carrito para confirmar detalles.</p>
                        </div>
                        <div class="flex flex-col items-center">
                            <span class="flex items-center justify-center w-12 h-12 bg-green-200 rounded-full ring-4 ring-white font-bold text-green-700 text-lg">3</span>
                             <h4 class="font-bold text-sm mt-2 mb-1">Realiza el Pago</h4>
                             <p class="text-xs text-gray-600">Elige una de nuestras opciones de pago.</p>
                        </div>
                        <div class="flex flex-col items-center">
                            <span class="flex items-center justify-center w-12 h-12 bg-green-200 rounded-full ring-4 ring-white font-bold text-green-700 text-lg">4</span>
                            <h4 class="font-bold text-sm mt-2 mb-1">¡Recibe tu Tesoro!</h4>
                            <p class="text-xs text-gray-600">Enviamos tu pedido a donde nos indiques.</p>
                        </div>
                    </div>

                    <!-- Desktop View: Vertical Timeline -->
                    <ol class="relative border-l-2 border-dashed border-gray-300 space-y-10 ml-4 hidden md:block">
                        <li class="pl-8">
                            <span class="absolute -left-5 flex items-center justify-center w-10 h-10 bg-green-200 rounded-full ring-8 ring-white font-bold text-green-700">1</span>
                            <h4 class="font-bold text-xl mb-1">Elige tu Producto</h4>
                            <p class="text-gray-600">Navega por nuestra galería y añade tus creaciones favoritas al carrito.</p>
                        </li>
                        <li class="pl-8">
                            <span class="absolute -left-5 flex items-center justify-center w-10 h-10 bg-green-200 rounded-full ring-8 ring-white font-bold text-green-700">2</span>
                            <h4 class="font-bold text-xl mb-1">Confirma por WhatsApp</h4>
                            <p class="text-gray-600">Envíanos tu carrito por WhatsApp para confirmar los detalles y disponibilidad.</p>
                        </li>
                         <li class="pl-8">
                            <span class="absolute -left-5 flex items-center justify-center w-10 h-10 bg-green-200 rounded-full ring-8 ring-white font-bold text-green-700">3</span>
                            <h4 class="font-bold text-xl mb-1">Realiza el Pago</h4>
                            <p class="text-gray-600">Elige una de las opciones de pago que te ofrecemos a continuación.</p>
                        </li>
                        <li class="pl-8">
                            <span class="absolute -left-5 flex items-center justify-center w-10 h-10 bg-green-200 rounded-full ring-8 ring-white font-bold text-green-700">4</span>
                            <h4 class="font-bold text-xl mb-1">¡Recibe tu Tesoro!</h4>
                            <p class="text-gray-600">Una vez confirmado el pago, enviaremos tu pedido a la dirección que nos indiques.</p>
                        </li>
                    </ol>
                </div>
    
                <div class="grid grid-cols-2 gap-4 mt-12 pt-8 border-t-2 border-dashed border-gray-200">
                    <!-- Card Payment -->
                    <div class="bg-white p-4 md:p-6 rounded-2xl shadow-lg border border-gray-100 flex flex-col">
                        <h4 class="text-xl md:text-2xl font-bold mb-4 text-center">Pago con Tarjeta</h4>
                        <p class="text-gray-600 mb-6 text-center flex-grow text-sm md:text-base">Aceptamos todas las tarjetas de crédito y débito.</p>
                        <button class="btn-primary w-full opacity-50 cursor-not-allowed mt-auto text-sm" disabled>Pagar con Tarjeta (Próximamente)</button>
                    </div>
                    <!-- Bank Transfer -->
                    <div class="bg-white p-4 md:p-6 rounded-2xl shadow-lg border border-gray-100 flex flex-col">
                         <h4 class="text-xl md:text-2xl font-bold mb-4 text-center">Transferencia Bancaria</h4>
                         <p class="text-gray-600 mb-6 text-center flex-grow text-sm md:text-base">Realiza tu pago directamente a nuestra cuenta:</p>
                         <div class="bg-gray-100 p-3 md:p-4 rounded-lg text-left mt-auto space-y-1 text-sm">
                            <p class="text-gray-500 text-xs font-semibold">BANCO PICHINCHA</p>
                            <p><strong class="font-medium text-gray-800">Cta. Ahorros:</strong> <span class="font-mono tracking-wider">220XXXXX98</span></p>
                            <p><strong class="font-medium text-gray-800">Nombre:</strong> <span class="font-mono">Hannah Y.</span></p>
                            <p><strong class="font-medium text-gray-800">CI:</strong> <span class="font-mono">17XXXXXX56</span></p>
                         </div>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <!-- Footer (Original Structure) -->
    <footer class="text-white pt-16 pb-8" style="background-color: var(--text-dark);">
        <div class="container mx-auto px-6">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8 text-center md:text-left">
                <div class="flex flex-col items-center md:items-start">
                    <div class="flex items-center space-x-3 mb-4"><img src="./logo-dcore.jpg" alt="D'CORE Logo" class="w-12 h-12 rounded-full"><span class="text-2xl font-bold" style="font-family: 'Playfair Display', serif;">D'CORE</span></div>
                    <p class="max-w-xs text-gray-400">Un Legado de Detalles del Corazón.</p>
                </div>
                <div>
                    <h4 class="font-bold text-lg mb-4">Navegación</h4>
                    <ul class="space-y-2">
                        <li><a href="#nosotros" class="text-gray-400 hover:text-white transition-colors">Nuestra Historia</a></li>
                        <li><a href="#promociones" class="text-gray-400 hover:text-white transition-colors">Promociones</a></li>
                        <li><a href="#productos" class="text-gray-400 hover:text-white transition-colors">Productos</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-bold text-lg mb-4">Síganos</h4>
                    <div class="flex justify-center md:justify-start space-x-6">
                        <a href="https://www.instagram.com/_hannah.yanez/" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-white transform hover:scale-125 transition-transform"><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M12.315 2c2.43 0 2.784.013 3.808.06 1.064.049 1.791.218 2.427.465a4.902 4.902 0 011.772 1.153 4.902 4.902 0 011.153 1.772c.247.636.416 1.363.465 2.427.048 1.024.06 1.378.06 3.808s-.012 2.784-.06 3.808c-.049 1.064-.218 1.791-.465 2.427a4.902 4.902 0 01-1.153 1.772 4.902 4.902 0 01-1.772 1.153c-.636.247-1.363.416-2.427.465-1.024.048-1.378.06-3.808.06s-2.784-.013-3.808-.06c-1.064-.049-1.791-.218-2.427-.465a4.902 4.902 0 01-1.772-1.153 4.902 4.902 0 01-1.153-1.772c-.247-.636-.416-1.363-.465-2.427-.048-1.024-.06-1.378-.06-3.808s.012-2.784.06-3.808c.049-1.064.218-1.791.465-2.427a4.902 4.902 0 011.153-1.772A4.902 4.902 0 016.345 2.525c.636-.247 1.363-.416 2.427-.465C9.792 2.013 10.146 2 12.315 2zM12 7.044c-2.749 0-4.973 2.224-4.973 4.973S9.251 16.99 12 16.99s4.973-2.224 4.973-4.973S14.749 7.044 12 7.044zM12 14.9a2.904 2.904 0 110-5.808 2.904 2.904 0 010 5.808zM16.949 6.02a1.185 1.185 0 11-2.37.001 1.185 1.185 0 012.37-.001z" clip-rule="evenodd" /></svg></a>
                        <a href="https://wa.me/593987786632" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-white transform hover:scale-125 transition-transform"><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path d="M12.04 2C6.58 2 2.13 6.45 2.13 11.91C2.13 13.66 2.59 15.35 3.4 16.86L2.05 22L7.31 20.75C8.77 21.48 10.38 21.89 12.04 21.89C17.5 21.89 21.95 17.44 21.95 11.98C21.95 9.32 20.96 6.84 19.13 4.99C17.28 3.14 14.79 2 12.04 2M12.04 3.67C14.24 3.67 16.31 4.53 17.87 6.09C19.42 7.65 20.28 9.72 20.28 11.92C20.28 16.56 16.59 20.25 11.95 20.25C10.46 20.25 9.03 19.88 7.79 19.18L7.42 18.96L4.38 19.78L5.22 16.81L4.97 16.42C4.18 15.11 3.77 13.54 3.77 11.91C3.77 7.27 7.46 3.67 12.04 3.67M9.13 7.5C8.91 7.5 8.7 7.55 8.51 7.92C8.31 8.29 7.68 9.53 7.68 10.84C7.68 12.15 8.53 13.4 8.68 13.58C8.83 13.77 10.56 16.32 13.08 17.31C15.04 18.06 15.61 17.84 16.08 17.79C16.56 17.74 17.42 17.22 17.62 16.56C17.81 15.89 17.81 15.35 17.74 15.25C17.67 15.16 17.47 15.09 17.22 14.97C16.97 14.84 15.71 14.22 15.49 14.13C15.26 14.04 15.11 13.99 14.96 14.27C14.81 14.55 14.34 15.11 14.2 15.28C14.07 15.45 13.92 15.47 13.67 15.35C13.42 15.22 12.63 14.95 11.67 14.1C10.91 13.43 10.39 12.61 10.27 12.35C10.14 12.1 10.26 11.97 10.39 11.84C10.5 11.73 10.64 11.53 10.79 11.36C10.93 11.19 10.98 11.07 11.08 10.89C11.18 10.71 11.13 10.56 11.06 10.44C10.98 10.32 10.56 9.23 10.36 8.75C10.17 8.27 9.98 7.85 9.81 7.85C9.64 7.85 9.46 7.85 9.28 7.85" /></svg></a>
                    </div>
                </div>
            </div>
            <div class="border-t border-gray-700 mt-8 pt-6 text-center text-gray-400">
                <p>&copy; 2025 D'CORE. Hecho con ❤️ en Ecuador.</p>
                <p class="text-sm mt-2">Diseñado por <a href="https://www.goatify.app/web" target="_blank" rel="noopener noreferrer" class="font-semibold text-white hover:underline">Goatify IA</a> en colaboración con <b class="font-semibold text-white">Hannah Yánez</b>, cofundadora de la marca D´CORE.</p>
            </div>
        </div>
    </footer>

    <!-- Toast, Modals & Chatbot -->
    <div id="toast" class="fixed bottom-8 left-1/2 -translate-x-1/2 bg-gray-800 text-white px-6 py-3 rounded-full shadow-lg transition-all duration-500 opacity-0 -translate-y-4 z-[2001]"></div>
    
    <div id="info-modal-overlay">
        <div id="info-modal" class="max-w-lg w-11/12 bg-white rounded-2xl p-8 shadow-2xl z-[2001]">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-2xl font-bold">¿Cómo Funciona el Guardián?</h3>
                <button id="close-info-modal" class="text-3xl text-gray-500 hover:text-red-500">&times;</button>
            </div>
            <ol class="list-decimal list-inside space-y-3 text-gray-700">
                <li>Haga clic en cualquier día del calendario para seleccionarlo.</li>
                <li>Llene el nombre de su evento (Ej: Cumpleaños de Mamá) y haga clic en "Agendar".</li>
                <li>Su fecha se guardará en su navegador y aparecerá en la lista de "Fechas del Mes".</li>
                <li>¡Listo! La próxima vez que visite la página en ese mes, verá su recordatorio.</li>
                <li>Para un recordatorio personal, use el botón de WhatsApp <strong>( <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 inline-block" viewBox="0 0 20 20" fill="currentColor"><path d="M2 3a1 1 0 011-1h2.153a1 1 0 01.986.836l.74 4.435a1 1 0 01-.54 1.06l-1.518.76a11.034 11.034 0 006.364 6.364l.76-1.518a1 1 0 011.06-.54l4.435.74a1 1 0 01.836.986V17a1 1 0 01-1 1h-2C7.82 18 2 12.18 2 5V3z" /></svg> )</strong> junto a su evento para enviarnos un mensaje y nosotros le avisaremos.</li>
            </ol>
        </div>
    </div>

    <div id="chat-overlay"></div>
    <div id="chat-widget">
        <div id="chat-window">
            <div class="chat-header text-white rounded-t-2xl p-4 flex justify-between items-center">
                <div class="flex items-center gap-3">
                    <div class="relative w-12 h-12">
                        <div class="bot-avatar bg-white">🧶</div>
                        <span class="absolute bottom-0 right-0 w-3 h-3 bg-green-400 rounded-full border-2 border-green-800"></span>
                    </div>
                    <div>
                        <h3 class="font-bold text-lg">Asistente D'CORE</h3>
                        <p class="text-sm opacity-90">En línea para ayudarle</p>
                    </div>
                </div>
                <button id="close-chat" class="text-2xl opacity-80 hover:opacity-100">&times;</button>
            </div>
            <div id="chat-body" class="flex-1 overflow-y-auto flex flex-col"></div>
            <form id="chat-form" class="p-4 bg-white rounded-b-2xl">
                 <div id="chat-options-container" class="pb-2"></div>
                <div class="flex gap-2">
                    <input type="text" id="chat-input" placeholder="Escriba su mensaje..." class="flex-1 p-3 border border-gray-300 rounded-full focus:ring-2 focus:ring-green-400 text-sm" autocomplete="off">
                    <button type="submit" class="bg-green-500 text-white rounded-full w-12 h-12 flex items-center justify-center flex-shrink-0 transition-transform hover:scale-110">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M13 5l7 7-7 7M5 12h14" /></svg>
                    </button>
                </div>
            </form>
        </div>
        <button id="chat-button">🧶</button>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- ORIGINAL DATA & CONFIG ---
            const PROMOTION_DISCOUNT = 0.15;
            const PROMOTION_CATEGORIES = ['tejido', 'bordado'];
            const allProducts = [
                { name: "Amigurumi Pollito", price: 22.00, image: "./IMG-20250830-WA0045.jpg", category: 'tejido' },
                { name: "Sudadera Bordada Floral", price: 45.00, image: "./IMG-20250830-WA0046.jpg", category: 'bordado' },
                { name: "Amigurumi Stich", price: 25.00, image: "./IMG-20250830-WA0047.jpg", category: 'tejido' },
                { name: "Llavero de Madera", price: 15.00, image: "./IMG-20250830-WA0042.jpg", category: 'madera' },
                { name: "Detalle en Madera", price: 18.00, image: "./IMG-20250830-WA0043.jpg", category: 'madera' },
                { name: "Bordado Personalizado", price: 35.00, image: "./IMG-20250830-WA0044.jpg", category: 'bordado' },
                { name: "Caja de Recuerdos", price: 30.00, image: "./IMG-20250830-WA0039.jpg", category: 'madera' },
                { name: "Amigurumi Osito", price: 20.00, image: "./IMG-20250830-WA0040.jpg", category: 'tejido' },
                { name: "Detalle Bordado Corazón", price: 28.00, image: "./IMG-20250830-WA0041.jpg", category: 'bordado' },
                { name: "Recuerdo Familiar", price: 40.00, image: "./IMG-20250830-WA0037.jpg", category: 'madera' },
                { name: "Base de Madera Decorativa", price: 25.00, image: "./IMG-20250830-WA0036.jpg", category: 'madera' },
                { name: "Llavero Aguacate", price: 12.00, image: "./IMG-20250830-WA0033.jpg", category: 'tejido' },
                { name: "Set de Llaveros", price: 20.00, image: "./IMG-20250830-WA0034.jpg", category: 'madera' },
                { name: "Llavero Tejido", price: 10.00, image: "./IMG-20250830-WA0035.jpg", category: 'tejido' },
                { name: "Grabado en Madera", price: 28.00, image: "./IMG-20250830-WA0031.jpg", category: 'madera' },
                { name: "Recuerdo en Madera", price: 26.00, image: "./IMG-20250830-WA0032.jpg", category: 'madera' },
                { name: "Figura de Madera Girasol", price: 24.00, image: "./IMG-20250830-WA0028.jpg", category: 'madera' },
                { name: "Llavero Tallado Gato", price: 15.00, image: "./IMG-20250830-WA0029.jpg", category: 'madera' },
                { name: "Caja de Madera Personalizada", price: 30.00, image: "./IMG-20250830-WA0030.jpg", category: 'madera' },
                { name: "Detalle Tallado Especial", price: 18.00, image: "./IMG-20250830-WA0027.jpg", category: 'madera' },
                { name: "Amigurumi Dinosaurio", price: 25.00, image: "./IMG-20250830-WA0025.jpg", category: 'tejido' },
                { name: "Muñeco de Lana (Diseño 2)", price: 25.00, image: "./IMG-20250830-WA0026.jpg", category: 'tejido' },
                { name: "Llavero Tallado (Diseño 2)", price: 15.00, image: "./IMG-20250830-WA0023.jpg", category: 'madera' },
                { name: "Camiseta Bordada (Diseño 2)", price: 40.00, image: "./IMG-20250830-WA0024.jpg", category: 'bordado' },
                { name: "Figura de Madera Grabada", price: 35.00, image: "./IMG-20250830-WA0020.jpg", category: 'madera' },
                { name: "Muñeco Personalizado", price: 50.00, image: "./IMG-20250830-WA0021.jpg", category: 'tejido' },
                { name: "Caja de Madera (Diseño 2)", price: 32.00, image: "./IMG-20250830-WA0022.jpg", category: 'madera' },
            ];
            const testimonials = [{ text: "¡El muñeco que pedí superó mis expectativas! La calidad y el cariño que le ponen a cada detalle es increíble. 100% recomendado.", author: "Ana G., Quito" }, { text: "El regalo perfecto. Mi sudadera bordada es mi nueva prenda favorita. Gracias D'CORE por crear algo tan especial.", author: "Carlos R., Guayaquil" }, { text: "Excelente servicio y el grabado en madera quedó precioso. Un recuerdo que atesoraré para siempre.", author: "Sofía M., Cuenca" }, { text: "El llavero de aguacate es adorable. Se nota que está hecho con mucho amor. ¡Definitivamente volveré a comprar!", author: "Mateo V., Ambato" }, { text: "¡Me encantó! El envío fue súper rápido y el producto llegó en perfectas condiciones. Calidad de exportación.", author: "Valentina C., Manta" }];

            const showToast = (message) => { const toast = document.getElementById('toast'); toast.textContent = message; toast.classList.remove('opacity-0', '-translate-y-4'); toast.classList.add('opacity-100', 'translate-y-0'); setTimeout(() => { toast.classList.remove('opacity-100', 'translate-y-0'); toast.classList.add('opacity-0', '-translate-y-4'); }, 3000); };
            const observer = new IntersectionObserver((entries) => { entries.forEach(entry => { if (entry.isIntersecting) { entry.target.classList.add('in-view'); observer.unobserve(entry.target); } }); }, { threshold: 0.1 });
            document.querySelectorAll('.fade-in-up').forEach(el => observer.observe(el));

            // --- COUNTDOWN TIMER ---
            (() => {
                const countdownEl = document.getElementById("countdown");
                if (!countdownEl) return;
                const endOfMonth = new Date(new Date().getFullYear(), new Date().getMonth() + 1, 1);
                endOfMonth.setHours(0,0,0,0);
                
                const interval = setInterval(() => {
                    const now = new Date().getTime();
                    const distance = endOfMonth - now;

                    if (distance < 0) {
                        clearInterval(interval);
                        countdownEl.innerHTML = "<p class='text-xl font-bold'>¡LA OFERTA HA TERMINADO!</p>";
                        return;
                    }

                    document.getElementById("days").innerText = Math.floor(distance / (1000 * 60 * 60 * 24)).toString().padStart(2, '0');
                    document.getElementById("hours").innerText = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60)).toString().padStart(2, '0');
                    document.getElementById("minutes").innerText = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60)).toString().padStart(2, '0');
                    document.getElementById("seconds").innerText = Math.floor((distance % (1000 * 60)) / 1000).toString().padStart(2, '0');
                }, 1000);
            })();

            // --- CAROUSELS (Original Logic) ---
            (() => {
                const heroWrapper = document.getElementById('hero-carousel-wrapper');
                allProducts.forEach(product => { heroWrapper.innerHTML += `<div class="swiper-slide"><img src="${product.image}" alt="${product.name}" loading="lazy"></div>`; });
                new Swiper('.hero-swiper', { loop: true, autoplay: { delay: 3000, disableOnInteraction: false }, pagination: { el: '.swiper-pagination', clickable: true }, effect: 'slide', grabCursor: true });
                
                const testimonialsWrapper = document.getElementById('testimonials-wrapper');
                const starSVG = `<svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" /></svg>`.repeat(5);
                testimonials.forEach(t => testimonialsWrapper.innerHTML += `<div class="swiper-slide text-center p-8"><div class="flex justify-center mb-4 text-yellow-500">${starSVG}</div><p class="text-xl italic text-gray-700">"${t.text}"</p><p class="mt-4 font-bold text-lg">- ${t.author}</p></div>`);
                new Swiper('.testimonials-swiper', { loop: true, autoplay: { delay: 5000, disableOnInteraction: false }, pagination: { el: '.swiper-pagination', clickable: true }, grabCursor: true });
            })();

            // --- PRODUCTS & CART (Original Logic) ---
            (() => {
                const productGrid = document.getElementById('product-grid');
                allProducts.forEach((product) => {
                    const isOnSale = PROMOTION_CATEGORIES.includes(product.category);
                    const finalPrice = isOnSale ? product.price * (1 - PROMOTION_DISCOUNT) : product.price;
                    const saleBadgeHTML = isOnSale ? `<div class="sale-badge">${PROMOTION_DISCOUNT * 100}% OFF</div>` : '';
                    const priceHTML = isOnSale ? `<div class="flex items-center justify-center gap-2"><span class="text-gray-500 line-through text-base">$${product.price.toFixed(2)}</span><span class="text-2xl font-bold" style="color:var(--primary-red)">$${finalPrice.toFixed(2)}</span></div>` : `<span class="text-2xl font-bold">$${product.price.toFixed(2)}</span>`;
                    productGrid.innerHTML += `<div class="product-card flex flex-col text-center"><div class="overflow-hidden relative"><img src="${product.image}" alt="${product.name}" class="w-full h-56 object-cover" onerror="this.onerror=null;this.src='https://placehold.co/400x400/FFFAF5/402A24?text=${encodeURIComponent(product.name)}';">${saleBadgeHTML}</div><div class="p-4 md:p-6 flex flex-col flex-grow"><h3 class="text-lg font-semibold mb-2 flex-grow">${product.name}</h3><div class="my-4">${priceHTML}</div><button class="add-to-cart-btn btn-primary mt-auto text-sm" data-name="${product.name}" data-price="${finalPrice}" data-image="${product.image}">Añadir al Carrito</button></div></div>`;
                });
                let cart = [];
                const cartModal = document.getElementById('cart-modal');
                const updateCart = () => {
                    const cartItems = document.getElementById('cart-items'), totalEl = document.getElementById('cart-total'), countEl = document.getElementById('cart-count');
                    cartItems.innerHTML = ''; let total = 0, count = 0;
                    if (cart.length === 0) { cartItems.innerHTML = '<p class="text-center text-gray-500 py-10">Tu carrito está vacío.</p>'; countEl.classList.add('hidden'); }
                    else { cart.forEach((item, index) => { total += item.price * item.quantity; count += item.quantity; cartItems.innerHTML += `<div class="flex items-center space-x-4 p-2 bg-gray-50 rounded-lg"><img src="${item.image}" alt="${item.name}" class="w-16 h-16 object-cover rounded-md"><div class="flex-1"><h4 class="font-bold text-sm">${item.name}</h4><p class="text-xs text-gray-600">$${item.price.toFixed(2)}</p><div class="flex items-center mt-1"><button class="quantity-change text-lg font-bold px-2" data-index="${index}" data-amount="-1">-</button><span class="px-3 text-sm">${item.quantity}</span><button class="quantity-change text-lg font-bold px-2" data-index="${index}" data-amount="1">+</button></div></div><span class="font-semibold text-lg">$${(item.price*item.quantity).toFixed(2)}</span></div>`; }); countEl.textContent = count; countEl.classList.remove('hidden'); }
                    totalEl.textContent = `$${total.toFixed(2)}`;
                };
                document.getElementById('cart-btn').addEventListener('click', () => cartModal.classList.remove('translate-x-full'));
                document.getElementById('close-cart-btn').addEventListener('click', () => cartModal.classList.add('translate-x-full'));
                document.getElementById('product-grid').addEventListener('click', e => { if (e.target.classList.contains('add-to-cart-btn')) { const {name, price, image} = e.target.dataset; const existing = cart.find(i => i.name === name); if (existing) existing.quantity++; else cart.push({ name, price: +price, image, quantity: 1 }); updateCart(); showToast(`'${name}' añadido.`); }});
                document.getElementById('cart-items').addEventListener('click', e => { if(e.target.classList.contains('quantity-change')) { const {index, amount} = e.target.dataset; cart[index].quantity += +amount; if(cart[index].quantity <= 0) cart.splice(index, 1); updateCart(); }});
                document.getElementById('whatsapp-btn').addEventListener('click', () => { if (cart.length === 0) { showToast("Tu carrito está vacío."); return; } let msg = "¡Hola D'CORE! ✨ Me gustaría comprar los siguientes productos:\n\n"; cart.forEach(i => { msg += `*${i.quantity}x* - ${i.name} ($${i.price.toFixed(2)} c/u)\n`; }); msg += `\n*Total a pagar: ${document.getElementById('cart-total').textContent}*\n\n¡Gracias! Quedo a la espera de su confirmación. 😊`; window.open(`https://wa.me/593987786632?text=${encodeURIComponent(msg)}`, '_blank'); });
                updateCart();
            })();

            // --- CALENDAR LOGIC (EXPANDED DATES & FUNCTIONALITY) ---
            (() => {
                let currentDate = new Date();
                const importantDates = {0:[{d:1,e:"Año Nuevo"},{d:4,e:"Día del Braille"},{d:13,e:"Día Mundial del Chicle"},{d:21,e:"Día del Abrazo"},{d:24,e:"Día del Community Manager"}],1:[{d:4,e:"Día contra el Cáncer"},{d:9,e:"Día de la Pizza"},{d:13,e:"Día del Soltero"},{d:14,e:"San Valentín"},{d:17,e:"Día del Gato"}],2:[{d:8,e:"Día de la Mujer"},{d:14,e:"Día de Pi"},{d:15,e:"Día del Sueño"},{d:19,e:"Día del Hombre/Artesano"},{d:20,e:"Día de la Felicidad"},{d:21,e:"Día del Perro/Poesía"}],3:[{d:1,e:"April Fools (Bromas)"},{d:7,e:"Día de la Salud"},{d:13,e:"Día del Beso"},{d:15,e:"Día Mundial del Arte"},{d:22,e:"Día de la Tierra"},{d:23,e:"Día del Libro"}],4:[{d:1,e:"Día del Trabajo"},{d:4,e:"Día de Star Wars"},{d:9,e:"Día de Goku"},{d:12,e:"Día de la Madre (EC)"},{d:15,e:"Día del Maestro (EC)"},{d:24,e:"Batalla de Pichincha"},{d:25,e:"Día del Orgullo Friki"}],5:[{d:1,e:"Día del Niño"},{d:5,e:"Día del Medio Ambiente"},{d:8,e:"Día de los Océanos"},{d:16,e:"Día del Padre (EC)"},{d:21,e:"Día de la Música"},{d:28,e:"Día del Orgullo LGBTQ+"}],6:[{d:4,e:"Indep. de EEUU"},{d:13,e:"Día del Rock"},{d:17,e:"Día del Emoji"},{d:20,e:"Día del Amigo"},{d:26,e:"Día de los Abuelos"}],7:[{d:8,e:"Día del Gato"},{d:10,e:"Primer Grito de Independencia"},{d:13,e:"Día de los Zurdos"},{d:19,e:"Día de la Fotografía"},{d:26,e:"Día del Perro (Global)"}],8:[{d:1,e:"Día de la Barba"},{d:13,e:"Día de los Programadores"},{d:19,e:"Día de Hablar como un Pirata"},{d:21,e:"Día de la Paz"},{d:27,e:"Día del Turismo"}],9:[{d:4,e:"Día de los Animales"},{d:9,e:"Indep. de Guayaquil"},{d:16,e:"Día del Jefe"},{d:21,e:"Día de Volver al Futuro"},{d:26,e:"Día de la Suegra"},{d:31,e:"Halloween / Día del Escudo"}],10:[{d:1,e:"Día del Veganismo"},{d:2,e:"Día de los Difuntos"},{d:3,e:"Indep. de Cuenca"},{d:11,e:"Black Friday (aprox)"},{d:13,e:"Día de la Bondad"}],11:[{d:6,e:"Fundación de Quito"},{d:24,e:"Nochebuena"},{d:25,e:"Navidad"},{d:28,e:"Día de los Inocentes"},{d:31,e:"Fin de Año"}]};
                let userEvents = JSON.parse(localStorage.getItem('dcoreUserEvents')) || [];

                const infoModalOverlay = document.getElementById('info-modal-overlay');
                const openInfoModal = () => infoModalOverlay.classList.add('open');
                const closeInfoModal = () => infoModalOverlay.classList.remove('open');
                document.getElementById('info-btn').addEventListener('click', openInfoModal);
                document.getElementById('close-info-modal').addEventListener('click', closeInfoModal);
                infoModalOverlay.addEventListener('click', (e) => { if(e.target === infoModalOverlay) closeInfoModal(); });
                
                const renderCalendar = () => {
                    const calendarEl=document.getElementById('calendar'), monthYearEl=document.getElementById('month-year'), eventsListEl=document.getElementById('events-list'), eventsMonthEl=document.getElementById('events-month');
                    calendarEl.innerHTML=''; eventsListEl.innerHTML='';
                    const year=currentDate.getFullYear(), month=currentDate.getMonth();
                    const monthName = currentDate.toLocaleDateString('es-ES',{month:'long'});
                    monthYearEl.textContent=`${monthName.charAt(0).toUpperCase()+monthName.slice(1)} ${year}`;
                    eventsMonthEl.textContent=monthName;
                    
                    const allEventsThisMonth = [];
                    (importantDates[month]||[]).forEach(evt => allEventsThisMonth.push({ ...evt, type: 'official' }));
                    userEvents.filter(e=>e.m===month && e.y===year).forEach(evt => allEventsThisMonth.push({ ...evt, type: 'user' }));

                    allEventsThisMonth.sort((a,b) => a.d - b.d).forEach(evt => {
                        const li = document.createElement('li');
                        li.className = 'flex justify-between items-center';
                        let html = '';
                        if (evt.type === 'user') {
                            html += `<span><strong class="text-green-500">${evt.d}:</strong> ${evt.e}</span><button class="send-reminder-btn p-1 rounded-full hover:bg-green-100" data-name="${evt.e}" data-date="${evt.y}-${(evt.m+1).toString().padStart(2,'0')}-${evt.d.toString().padStart(2,'0')}"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-green-600" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2zM9 8h6m-3-3v6" /></svg></button>`;
                        } else {
                            html += `<span><strong class="text-red-500">${evt.d}:</strong> ${evt.e}</span>`;
                        }
                        li.innerHTML = html;
                        eventsListEl.appendChild(li);
                    });

                    if(eventsListEl.innerHTML==='') eventsListEl.innerHTML='<li>No hay eventos este mes.</li>';
                    
                    const firstDayOfMonth=(new Date(year,month,1).getDay() + 7) % 7;
                    const daysInMonth=new Date(year,month+1,0).getDate();
                    for(let i=0;i<firstDayOfMonth;i++) calendarEl.innerHTML+='<div class="empty"></div>';
                    for(let day=1;day<=daysInMonth;day++){
                        const dayEl=document.createElement('div');
                        dayEl.textContent=day; dayEl.className='calendar-day';
                        dayEl.dataset.day = day;
                        if(importantDates[month] && importantDates[month].some(e=>e.d===day)) dayEl.classList.add('has-event');
                        if(userEvents.some(e=>e.d===day&&e.m===month&&e.y===year)) dayEl.classList.add('user-event');
                        if(day===new Date().getDate()&&month===new Date().getMonth()&&year===new Date().getFullYear()) dayEl.classList.add('today');
                        calendarEl.appendChild(dayEl);
                    }
                };

                document.getElementById('calendar').addEventListener('click', (e) => {
                    if (e.target.classList.contains('calendar-day') && !e.target.classList.contains('empty')) {
                        const day = e.target.dataset.day;
                        const dateStr = `${currentDate.getFullYear()}-${(currentDate.getMonth()+1).toString().padStart(2,'0')}-${day.toString().padStart(2,'0')}`;
                        document.getElementById('event-date').value = dateStr;
                        document.getElementById('event-name').focus();
                    }
                });
                
                document.getElementById('events-list').addEventListener('click', (e) => {
                    const button = e.target.closest('.send-reminder-btn');
                    if (button) {
                        const { name, date } = button.dataset;
                        const formattedDate=new Date(date+'T00:00:00').toLocaleDateString('es-EC',{dateStyle:'full'});
                        const text=`¡Hola D'CORE! Le escribo para recordarles mi fecha especial: "${name}" el ${formattedDate}. ¡Gracias por el recordatorio!`;
                        window.open(`https://wa.me/593987786632?text=${encodeURIComponent(text)}`,'_blank');
                    }
                });

                document.getElementById('prev-month').addEventListener('click',()=>{currentDate.setMonth(currentDate.getMonth()-1);renderCalendar();});
                document.getElementById('next-month').addEventListener('click',()=>{currentDate.setMonth(currentDate.getMonth()+1);renderCalendar();});
                document.getElementById('date-form').addEventListener('submit',(e)=>{
                    e.preventDefault();
                    const eventName=document.getElementById('event-name').value;
                    const eventDate=document.getElementById('event-date').value;
                    if (!eventDate) { showToast("Por favor, seleccione una fecha."); return; }
                    const [year,month,day]=eventDate.split('-').map(Number);
                    userEvents.push({y:year,m:month-1,d:day,e:eventName});
                    localStorage.setItem('dcoreUserEvents',JSON.stringify(userEvents));
                    showToast(`'${eventName}' agendado.`); e.target.reset(); renderCalendar();
                });
                renderCalendar();
            })();

            // --- PREMIUM CHATBOT LOGIC ---
            (() => {
                const chatButton = document.getElementById('chat-button'), chatWindow = document.getElementById('chat-window'), closeChat = document.getElementById('close-chat'), chatBody = document.getElementById('chat-body'), chatForm = document.getElementById('chat-form'), chatInput = document.getElementById('chat-input'), optionsContainer = document.getElementById('chat-options-container'), chatOverlay = document.getElementById('chat-overlay');
                let isChatOpen = false;

                const toggleChat = () => {
                    isChatOpen = !isChatOpen;
                    chatWindow.classList.toggle('open'); 
                    chatButton.classList.toggle('open');
                    chatOverlay.classList.toggle('open');
                };

                chatButton.addEventListener('click', toggleChat);
                closeChat.addEventListener('click', toggleChat);
                chatOverlay.addEventListener('click', () => { if(isChatOpen) toggleChat(); });

                const addMessage = (text, sender) => {
                    const container = document.createElement('div');
                    container.className = `chat-message-container ${sender}-message-container`;
                    let messageHTML = '';
                    if (sender === 'bot') { messageHTML += `<div class="bot-avatar">🧶</div>`; }
                    messageHTML += `<div class="chat-message">${text}</div>`;
                    container.innerHTML = messageHTML;
                    if (sender === 'user') {
                        const userContainer = document.createElement('div');
                        userContainer.className = 'user-message';
                        userContainer.appendChild(container);
                        chatBody.appendChild(userContainer);
                    } else {
                        const botContainer = document.createElement('div');
                        botContainer.className = 'bot-message';
                        botContainer.appendChild(container);
                        chatBody.appendChild(botContainer);
                    }
                    chatBody.scrollTop = chatBody.scrollHeight;
                };

                const showTyping = () => {
                    const container = document.createElement('div');
                    container.className = 'bot-message';
                    const innerContainer = document.createElement('div');
                    innerContainer.className = 'chat-message-container bot-message-container';
                    innerContainer.innerHTML = `<div class="bot-avatar">🧶</div><div class="chat-message typing-indicator"><span></span><span></span><span></span></div>`;
                    container.appendChild(innerContainer);
                    chatBody.appendChild(container);
                    chatBody.scrollTop = chatBody.scrollHeight;
                    return container;
                };
                
                const showOptions = (options) => {
                    optionsContainer.innerHTML = '';
                    if (!options || options.length === 0) return;
                    const container = document.createElement('div');
                    container.className = 'chat-options';
                    options.forEach(opt => {
                        const btn = document.createElement('button');
                        btn.textContent = opt.text;
                        btn.dataset.payload = opt.payload;
                        container.appendChild(btn);
                    });
                    optionsContainer.appendChild(container);
                };

                const getProductInfo = (query) => {
                    const lowerQuery = query.toLowerCase();
                    const foundProduct = allProducts.find(p => p.name.toLowerCase().includes(lowerQuery));
                    return foundProduct;
                };
                
                const conversationTree = {
                    'start': { response: "¡Bienvenido/a a D'CORE! Soy su asistente virtual. ¿Cómo puedo ayudarle hoy?", options: [{text:"Ver Productos", payload:"products"}, {text:"Nuestros Talleres", payload:"workshops"}, {text:"Promociones", payload:"promotions"}, {text:"Envíos y Pagos", payload:"shipping_payment"}, {text:"Sobre D'CORE", payload:"about_us"}, {text:"Hablar con un Humano", payload:"human"}] },
                    'products': { response: "¡Excelente! Nuestras creaciones son el alma de D'CORE. ¿Qué categoría le interesa explorar?", options: [{text:"Tejidos (Amigurumis)", payload:"prod_tejido"}, {text:"Bordados (Ropa)", payload:"prod_bordado"}, {text:"Madera (Detalles)", payload:"prod_madera"},{text:"Muebles a Medida", payload:"prod_muebles"}, {text:"Cotizar Idea Personal", payload:"custom"}, {text:"Volver al inicio", payload:"start"}] },
                    'prod_tejido': { response: "Los amigurumis son nuestra especialidad. Cada uno es único. Los precios varían desde $12 (llaveros) hasta $50+ (personajes complejos). ¿Le gustaría cotizar un personaje o ver la galería?", options: [{text:"Ver Galería", payload:"go_products"}, {text:"Cotizar Personaje", payload:"custom"}, {text:"Volver a Productos", payload:"products"}]},
                    'prod_bordado': { response: "Bordamos diseños únicos en sudaderas y más. Una sudadera personalizada tiene un costo aproximado de $45. Podemos bordar casi cualquier idea que tenga. ¿Desea cotizar o ver ejemplos?", options: [{text:"Ver Galería", payload:"go_products"}, {text:"Cotizar Diseño", payload:"custom"}, {text:"Volver a Productos", payload:"products"}]},
                    'prod_madera': { response: "Creamos detalles memorables en madera, desde llaveros ($15) hasta cajas personalizadas y muebles. ¿Qué tiene en mente?", options: [{text:"Ver Galería", payload:"go_products"}, {text:"Info de Muebles", payload:"prod_muebles"},{text:"Volver a Productos", payload:"products"}]},
                    'prod_muebles': { response: "¡Claro! Fabricamos muebles a medida como anaqueles, muebles de cocina y centros de entretenimiento. Cada proyecto es único y se cotiza individualmente. ¿Le gustaría que un especialista le contacte?", options: [{text:"Sí, por favor", payload:"go_whatsapp_muebles"}, {text:"Ver sección de Muebles", payload:"go_muebles"},{text:"Volver", payload:"products"}]},
                    'workshops': { response: "Nuestros talleres son una experiencia inolvidable. ¿Cuál le llama más la atención?", options: [{text:"Amigurumi", payload:"w_amigurumi"}, {text:"Bordado Parejas", payload:"w_embroidery"}, {text:"Carpintería", payload:"w_wood"}, {text:"Asesoría 1-a-1", payload:"w_consult"}, {text:"Volver al inicio", payload:"start"}] },
                    'shipping_payment': { response: "Gestionamos todo para que su detalle llegue perfecto. ¿Qué información necesita?", options: [{text:"Costos de Envío", payload:"shipping_cost"}, {text:"Métodos de Pago", payload:"payment_methods"}, {text:"Volver", payload:"start"}] },
                    'reminders': { response: "¡Con gusto! Con nuestro 'Guardián de Fechas' nunca olvidará una ocasión especial. Puede agregar sus fechas en nuestro calendario interactivo para tener un recordatorio visual. ¿Le gustaría que le lleve a esa sección?", options: [{text:"Sí, llévame al calendario", payload:"go_calendar"}, {text:"No, gracias", payload:"thanks"}]},
                    'shipping_cost': { response: "El envío dentro de Quito tiene un valor de $3. Al resto del país es de $5 vía Servientrega, y su pedido llega en 2 a 3 días hábiles. ¡Vale la pena la espera!", options: [{text:"Ver métodos de pago", payload:"payment_methods"}, {text:"Volver", payload:"start"}]},
                    'payment_methods': { response: "Aceptamos pagos por transferencia o depósito. Aquí están los datos:<br><br><strong>BANCO PICHINCHA</strong><br><strong>Cuenta Ahorros:</strong> 220XXXXX98<br><strong>Nombre:</strong> Hannah Y.<br><strong>CI:</strong> 17XXXXXX56<br><br>El pago con tarjeta estará disponible próximamente. ¿Necesita saber algo más?", options: [{text:"Costos de envío", payload:"shipping_cost"}, {text:"¡Gracias, eso es todo!", payload:"thanks"}] },
                    'human': { response: "Será un placer ponerle en contacto con un miembro de nuestro equipo. Puede escribirnos directamente a nuestro WhatsApp para una atención personalizada.", options: [{text:"Ir a WhatsApp", payload:"go_whatsapp"}, {text:"Prefiero seguir aquí", payload:"start"}]},
                    'about_us': { response: "D'CORE nació de una tradición familiar entre 9 hermanos. En lugar de comprar regalos, los creábamos con el corazón. Esa pasión por los detalles únicos es lo que compartimos en cada pieza.", options: [{text:"Ver nuestra historia", payload:"go_about"}, {text:"Volver", payload:"start"}] },
                    'promotions': { response: "¡Tenemos promociones increíbles! <br>🎁 <strong>15% OFF</strong> en tejido y bordado por el mes de Amor y Amistad. <br>🎁 <strong>GRATIS</strong> un llavero grabado al inscribirte en cualquier taller. ¿Cuál le interesa más?", options: [{text:"Ver productos en oferta", payload:"go_products"}, {text:"Ver talleres", payload:"go_workshops"}, {text:"Volver", payload:"start"}] },
                    'unknown': { response: "Le pido disculpas, no he comprendido del todo su consulta. Puede reformularla o tal vez le interese uno de estos temas:", options: [{text:"Ver Productos", payload:"products"}, {text:"Info de Talleres", payload:"workshops"},{text:"Cotizar una Idea", payload:"custom"}]},
                    'custom': { response: "¡Me encanta esa iniciativa! Para cotizar una idea personalizada, lo mejor es que nos contacte por WhatsApp. ¿Le parece bien si le indico cómo?", options: [{text:"Sí, por favor", payload:"go_whatsapp"}, {text:"No, gracias", payload:"thanks"}]},
                    'thanks': { response: "¿Hay algo más en lo que pueda asistirle? Estoy a su disposición.", options: [{text:"Sí, volver al inicio", payload:"start"}, {text:"No, eso es todo", payload:"end"}] },
                    'end': { response: "Ha sido un verdadero placer atenderle. Si nos necesita, aquí estaremos. ¡Que tenga un excelente día!", options: []},
                    'w_amigurumi': { response: "El Taller de Amigurumi cuesta $45. Es perfecto para principiantes, dura 4 semanas e incluye todos los materiales. ¡Saldrá creando sus propios muñecos! ¿Le gustaría inscribirse?", options: [{text:"¡Sí, quiero unirme!", payload:"go_whatsapp_taller"}, {text:"Volver a Talleres", payload:"workshops"}]},
                    'w_embroidery': { response: "Es una de nuestras experiencias más bonitas. Cuesta $60 por pareja y es una sesión intensiva de 3 horas. ¡Perfecto para una cita diferente! ¿Desean reservar su espacio?", options: [{text:"¡Sí, reservar!", payload:"go_whatsapp_taller"}, {text:"Volver a Talleres", payload:"workshops"}]},
                    'w_wood': { response: "Nuestro taller de carpintería tiene un costo de $75. Aprenderá técnicas básicas para crear objetos decorativos. ¡Una habilidad para toda la vida! ¿Le gustaría saber las próximas fechas?", options: [{text:"Sí, consultar fechas", payload:"go_whatsapp_taller"}, {text:"Volver a Talleres", payload:"workshops"}]},
                    'w_consult': { response: "La asesoría 1-a-1 tiene un valor de $25 por hora. Ideal para despejar dudas puntuales. ¿Agendamos una sesión para usted?", options: [{text:"¡Sí, agendar!", payload:"go_whatsapp_taller"}, {text:"Volver a Talleres", payload:"workshops"}]}
                };
                
                const handlePayload = (payload) => {
                    if (payload === 'go_products') { window.location.hash = "productos"; if(isChatOpen) toggleChat(); return; }
                    if (payload === 'go_muebles') { window.location.hash = "muebles-medida"; if(isChatOpen) toggleChat(); return; }
                    if (payload === 'go_calendar') { window.location.hash = "reminder-service"; if(isChatOpen) toggleChat(); return; }
                    if (payload === 'go_workshops') { window.location.hash = "talleres"; if(isChatOpen) toggleChat(); return; }
                    if (payload === 'go_about') { window.location.hash = "nosotros"; if(isChatOpen) toggleChat(); return; }
                    if (payload === 'go_whatsapp') { window.open("https://wa.me/593987786632?text=Hola%20D'CORE,%20vengo%20desde%20la%20página%20web%20y%20quisiera%20más%20información.", '_blank'); return; }
                    if (payload === 'go_whatsapp_muebles') { window.open("https://wa.me/593987786632?text=Hola%20D'CORE,%20me%20interesa%20cotizar%20un%20mueble%20a%20medida.", '_blank'); return; }
                    if (payload === 'go_whatsapp_taller') { window.open("https://wa.me/593987786632?text=Hola%20D'CORE,%20me%20interesa%20inscribirme%20en%20un%20taller.", '_blank'); return; }

                    const node = conversationTree[payload];
                    if (node) { 
                        const typing = showTyping(); 
                        setTimeout(() => { 
                            typing.remove(); 
                            addMessage(node.response, 'bot'); 
                            showOptions(node.options); 
                        }, 1000); 
                    }
                };

                optionsContainer.addEventListener('click', e => { if (e.target.tagName === 'BUTTON') { const {payload} = e.target.dataset; addMessage(e.target.textContent, 'user'); handlePayload(payload); } });
                
                chatForm.addEventListener('submit', (e) => { 
                    e.preventDefault(); 
                    const userInput = chatInput.value.trim(); 
                    if(userInput) { 
                        addMessage(userInput, 'user'); 
                        chatInput.value = ''; 
                        const product = getProductInfo(userInput);
                        if (product) {
                            const response = `¡Claro! El producto '${product.name}' tiene un precio de $${product.price.toFixed(2)}. Es una excelente elección. ¿Desea que lo añada a su carrito o prefiere cotizarlo por WhatsApp?`;
                            const typing = showTyping();
                            setTimeout(() => {
                                typing.remove();
                                addMessage(response, 'bot');
                                showOptions([
                                    { text: `Añadir al carrito`, payload: `add_cart_${product.name}` },
                                    { text: "Cotizar por WhatsApp", payload: 'go_whatsapp' },
                                    { text: "No, gracias", payload: 'thanks' }
                                ]);
                            }, 1000);
                        } else {
                            handlePayload('unknown');
                        }
                    }
                });
                
                // Open chat automatically after a delay
                setTimeout(() => {
                    if (!isChatOpen && !sessionStorage.getItem('dcoreChatOpened')) {
                        toggleChat();
                        sessionStorage.setItem('dcoreChatOpened', 'true');
                    }
                }, 2500);

                addMessage(conversationTree.start.response, 'bot');
                showOptions(conversationTree.start.options);
            })();
        });
    </script>
</body>
</html>


