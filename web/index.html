<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GOATIFY.APP | Soluciones de IA y Desarrollo Web - GOATIFY IA</title>
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="Descubre las mejores soluciones de IA y desarrollo web con GOATIFY.APP. Potenciamos tu negocio con automatización, páginas web smart y chat con inteligencia artificial.">
    <meta name="keywords" content="Goatify, Goatify IA, inteligencia artificial, desarrollo web, automatización, chatbots, páginas web, soluciones IA">

    <!-- Favicon -->
    <link rel="icon" href="logos hd.png" type="image/png">

    <!-- External Libraries -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>

<style>
/* ===== STYLESHEET FOR PRICING PAGE V29 (TAILWIND HYBRID) ===== */
:root {
    --primary-color: #6d28d9; /* Deep Violet */
    --secondary-color: #4f46e5; /* Indigo */
    --accent-color: #00e5ff; /* Bright Cyan */
    --dark-color: #111827; /* Dark Gray */
    --light-color: #f9fafb; /* Very Light Gray */
    --white-color: #ffffff;
    --text-color: #374151; /* Medium Gray */
    --success-color: #10b981; /* Emerald Green */
    --warning-color: #f59e0b; /* Amber */
    --danger-color: #ef4444; /* Red */
    --font-main: 'Inter', sans-serif;
    --shadow-light: 0 4px 15px rgba(0, 0, 0, 0.05);
    --shadow-medium: 0 8px 30px rgba(0, 0, 0, 0.1);
    --shadow-dark: 0 10px 40px rgba(0, 0, 0, 0.15);
    --border-radius-sm: 0.5rem;
    --border-radius-md: 1rem;
    --border-radius-lg: 1.5rem;
    --header-height: 70px;
}

@keyframes aurora {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
}

@keyframes pulse-glow {
    0%, 100% { box-shadow: 0 0 5px #fff, 0 0 10px #fff, 0 0 15px var(--accent-color); }
    50% { box-shadow: 0 0 10px #fff, 0 0 20px var(--accent-color), 0 0 30px var(--accent-color); }
}

body { 
    font-family: var(--font-main); 
    color: var(--text-color); 
    background-color: var(--white-color);
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    animation: fadeIn 1s ease-out;
}

/* Custom Styles to complement Tailwind */
.aurora-background {
    background: linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab, #6d28d9, #4f46e5);
    background-size: 400% 400%;
    animation: aurora 15s ease infinite;
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    filter: blur(80px);
    opacity: 0.15;
    z-index: -1;
    transform: translateZ(0); /* GPU acceleration */
}

.promo-banner-animated {
    animation: pulse-glow 3s infinite;
}

.countdown-timer {
    display: flex;
    gap: 0.75rem;
    align-items: center;
    justify-content: center;
}
.countdown-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    background: rgba(0,0,0,0.2);
    padding: 0.25rem 0.6rem;
    border-radius: 0.5rem;
}
.countdown-number {
    font-size: 1.25rem;
    font-weight: 700;
    line-height: 1;
}
.countdown-label {
    font-size: 0.65rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.section-glow::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 80%;
    height: 80%;
    background: radial-gradient(circle, rgba(109, 40, 217, 0.1), transparent 70%);
    transform: translate(-50%, -50%);
    z-index: -1;
    pointer-events: none;
}

.btn { 
    padding: 12px 28px; 
    border-radius: 9999px; 
    font-weight: 700; 
    transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
    display: inline-flex; 
    align-items: center; 
    justify-content: center; 
    gap: 10px; 
    border: 2px solid transparent; 
    cursor: pointer; 
    font-size: 0.9rem; 
    text-transform: uppercase;
    letter-spacing: 0.8px;
    line-height: 1.2;
    text-decoration: none;
    box-shadow: var(--shadow-light);
}
.btn-primary { background: linear-gradient(45deg, var(--primary-color), var(--secondary-color)); color: var(--white-color); }
.btn-primary:hover { transform: translateY(-3px) scale(1.05); box-shadow: 0 10px 20px rgba(79, 70, 229, 0.3); }
.btn-outline { background-color: transparent; color: var(--primary-color); border-color: var(--primary-color); }
.btn-outline:hover { background-color: var(--primary-color); color: var(--white-color); transform: translateY(-2px); }
.btn-sm { font-size: 0.75rem; padding: 8px 18px; }
.btn-accent { background-color: var(--accent-color); color: var(--dark-color); border-color: var(--accent-color); }
.btn-accent:hover { background-color: #00cde5; transform: translateY(-2px); }

.pricing-card {
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    border: 1px solid #e5e7eb;
}
.pricing-card:hover {
    transform: translateY(-8px);
    box-shadow: var(--shadow-medium);
}
.pricing-card.popular {
    border: 2px solid var(--primary-color);
    transform: scale(1.05);
    box-shadow: 0 0 30px rgba(109, 40, 217, 0.2);
}
.pricing-card.popular:hover {
    transform: scale(1.08) translateY(-5px);
    box-shadow: 0 0 40px rgba(109, 40, 217, 0.3);
}

.faq-item.active .faq-question i { transform: rotate(180deg); color: var(--primary-color); }
.faq-item.active .faq-answer { max-height: 500px; padding-top: 1rem; padding-bottom: 1.5rem; }

/* Automation Plans Table */
.automation-table {
    width: 100%;
    min-width: 800px;
    border-collapse: collapse;
}
.automation-table th, .automation-table td { 
    padding: 10px 6px; /* Compact padding */
    border-bottom: 1px solid #eee; 
    vertical-align: middle; 
    text-align: center; 
    font-size: 0.8rem; /* Compact font size */
}
.automation-table .plan-header {
    font-size: 0.9rem;
}
.automation-table .plan-header.popular { border-top: 3px solid var(--primary-color); background: #f5f3ff; }
.automation-table .feature-category-row td { background: #fafafa; text-align: left; font-weight: 700; color: var(--primary-color); padding-left: 1rem; }
.automation-table .feature-check, .automation-table .feature-star { font-size: 1.1rem; color: var(--success-color); }
.automation-table .feature-star { color: var(--warning-color); }
.automation-table .feature-dash { font-size: 1.1rem; color: #ccc; }

.cart-fab {
    position: fixed; bottom: 30px; right: 30px; width: 60px; height: 60px;
    background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
    color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center;
    font-size: 1.8rem; box-shadow: var(--shadow-dark); cursor: pointer; z-index: 1500;
    transition: transform 0.3s ease;
}
.cart-fab:hover { transform: scale(1.1) rotate(10deg); }

.toast-message {
    position: fixed; bottom: -100px; left: 50%; transform: translateX(-50%);
    background-color: var(--dark-color); color: var(--white-color); padding: 12px 20px;
    border-radius: var(--border-radius-sm); box-shadow: var(--shadow-medium);
    z-index: 2500; transition: all 0.5s cubic-bezier(0.68, -0.55, 0.27, 1.55);
}
.toast-message.show { bottom: 40px; transform: translateX(-50%) scale(1); }

</style>
</head>
<body class="bg-white">

<div class="aurora-background"></div>

<header class="bg-white/80 backdrop-blur-lg shadow-sm sticky top-0 z-50 h-[70px] flex items-center transition-all duration-300">
    <div class="container mx-auto px-5">
        <nav class="flex justify-between items-center w-full">
            <a href="/" class="logo">
                <img src="logos hd.png" alt="GOATIFY Logo" class="h-11" onerror="this.onerror=null; this.src='https://placehold.co/150x45/6d28d9/ffffff?text=GOATIFY';">
            </a>
            <ul class="nav-links hidden md:flex items-center space-x-8">
                <li><a href="#web-designs" class="font-semibold text-gray-600 hover:text-[--primary-color] transition-colors">Páginas Web</a></li>
                <li><a href="#automation-plans" class="font-semibold text-gray-600 hover:text-[--primary-color] transition-colors">Automatización</a></li>
                <li><a href="#ai-chat-plans" class="font-semibold text-gray-600 hover:text-[--primary-color] transition-colors">AI Chat</a></li>
                <li><a href="#faq" class="font-semibold text-gray-600 hover:text-[--primary-color] transition-colors">FAQ</a></li>
            </ul>
            <div class="flex items-center gap-4">
                 <a href="https://calendly.com/goatify/reunion-express" class="btn btn-primary hidden sm:inline-flex" target="_blank">Agendar Demo</a>
                <div class="mobile-menu-icon md:hidden text-2xl cursor-pointer text-gray-700 hover:text-[--primary-color]">
                    <i class="fas fa-bars"></i>
                </div>
            </div>
        </nav>
    </div>
</header>

<main>
    <!-- Promo Banner Section -->
    <section id="promo-banner" class="bg-gradient-to-r from-[--primary-color] to-[--secondary-color] text-white py-4 shadow-lg promo-banner-animated">
        <div class="container mx-auto px-5 text-center font-semibold">
            <div class="flex flex-col sm:flex-row items-center justify-center gap-4">
                <p class="text-lg">🚀 ¡Oferta Especial! <strong>Página Web Smart ¡GRATIS!</strong> con tu plan Sales Pro</p>
                <div class="flex items-center gap-3">
                    <span class="font-bold text-sm hidden sm:inline">TERMINA EN:</span>
                    <div id="countdown-timer" class="countdown-timer"></div>
                </div>
            </div>
        </div>
    </section>

    <!-- Global Currency Converter Section -->
    <section id="currency-converter-section" class="py-8 bg-gray-50/50">
        <div class="container mx-auto px-5 flex flex-col sm:flex-row items-center justify-center gap-3 sm:gap-4">
            <h2 class="font-semibold text-md text-[--dark-color]">🌍 Ver precios en:</h2>
            <select id="currency-selector" class="p-2 rounded-full border-2 border-gray-300 font-semibold w-full max-w-[250px] text-center text-sm focus:ring-2 focus:ring-[--primary-color] focus:border-[--primary-color] transition-all">
                <option value="USD">USA / Ecuador (USD)</option>
                <option value="EUR">Europa (EUR)</option>
                <option value="MXN">México (MXN)</option>
                <option value="CLP">Chile (CLP)</option>
                <option value="PEN">Perú (PEN)</option>
                <option value="COP">Colombia (COP)</option>
                <option value="ARS">Argentina (ARS)</option>
                <option value="UYU">Uruguay (UYU)</option>
                <option value="CAD">Canadá (CAD)</option>
            </select>
        </div>
    </section>

    <!-- Web Designs Section -->
    <section class="section py-20 bg-[--light-color] relative section-glow" id="web-designs">
        <div class="container mx-auto px-5">
            <h1 class="text-4xl md:text-5xl font-extrabold text-center mb-4 text-[--dark-color]">Tu Página Web Smart: El Motor de Ventas</h1>
            <p class="text-center text-lg text-gray-600 max-w-4xl mx-auto mb-16">Creamos sitios web inteligentes y personalizados con código puro, diseñados para convertir visitantes en clientes. Olvídate de plantillas genéricas. Construimos desde cero para asegurar rendimiento, seguridad y una experiencia de usuario únicos.</p>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6" id="web-designs-container">
                <!-- Web designs will be populated by JS -->
            </div>
            <div class="bg-white p-8 rounded-3xl mt-16 max-w-5xl mx-auto text-center shadow-md border">
                <h3 class="text-2xl font-bold mb-6">Todos Nuestros Paquetes Web Incluyen</h3>
                <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-6 text-sm font-medium">
                    <div class="flex flex-col items-center gap-2"><i class="fas fa-mobile-alt text-3xl text-[--primary-color]"></i><span>Diseño Adaptable</span></div>
                    <div class="flex flex-col items-center gap-2"><i class="fas fa-rocket text-3xl text-[--primary-color]"></i><span>Alta Velocidad</span></div>
                    <div class="flex flex-col items-center gap-2"><i class="fas fa-shield-alt text-3xl text-[--primary-color]"></i><span>Seguridad (SSL)</span></div>
                    <div class="flex flex-col items-center gap-2"><i class="fas fa-search text-3xl text-[--primary-color]"></i><span>Amigable con SEO</span></div>
                    <div class="flex flex-col items-center gap-2"><i class="fas fa-headset text-3xl text-[--primary-color]"></i><span>Soporte Dedicado</span></div>
                    <div class="flex flex-col items-center gap-2"><i class="fab fa-whatsapp text-3xl text-[--primary-color]"></i><span>Botón WhatsApp</span></div>
                </div>
            </div>
             <div class="bg-indigo-100 border-l-4 border-indigo-500 text-indigo-800 p-5 rounded-2xl max-w-3xl mx-auto mt-8 text-base">
                <strong>Dominio:</strong> Con los planes de automatización Sales Pro o superiores, tu Web Smart gratuita se aloja en un subdominio (ej: <strong>tu-marca.goatify.app</strong>).
                <br>
                ¿Prefieres un dominio propio (ej: <strong>tu-marca.com</strong>)? Lo gestionamos por ti por solo <strong>$20 anuales</strong>.
            </div>
        </div>
    </section>

    <!-- AI Chat Plans Section -->
    <section class="section py-20" id="ai-chat-plans">
        <div class="container mx-auto px-5">
            <h2 class="text-4xl md:text-5xl font-extrabold text-center mb-4 text-[--dark-color]">Planes de GOATIFY AI Chat</h2>
            <p class="text-center text-lg text-gray-600 max-w-3xl mx-auto mb-8">Herramientas de IA para que las uses a tu manera. Crea, resuelve y vende desde un chat simple y poderoso.</p>
            <div class="bg-violet-100 border-l-4 border-[--primary-color] p-5 rounded-2xl max-w-3xl mx-auto mb-12 text-base">
                <p>Estos planes te dan <strong class="text-[--primary-color]">acceso directo a nuestra plataforma de IA</strong>. No requieren reunión. Simplemente elige un plan, regístrate y empieza a crear.</p>
            </div>

            <div class="max-w-4xl mx-auto grid grid-cols-2 gap-6 items-stretch" id="ai-chat-container">
                <!-- AI Chat plans will be populated by JS -->
            </div>
        </div>
    </section>

    <!-- Automation Plans Section -->
    <section class="section py-20 bg-[--light-color] relative section-glow" id="automation-plans">
        <div class="container mx-auto px-5">
            <h2 class="text-4xl md:text-5xl font-extrabold text-center mb-4 text-[--dark-color]">Planes de Automatización GOATIFY</h2>
            <p class="text-center text-lg text-gray-600 max-w-3xl mx-auto mb-8">Soluciones completas para automatizar tus ventas en WhatsApp, Redes Sociales y tu Página Web.</p>
            <div class="bg-violet-100 border-l-4 border-[--primary-color] p-5 rounded-2xl max-w-3xl mx-auto mb-12 text-base">
                <p>Estos planes son un servicio <strong>"llave en mano"</strong>. Incluyen una reunión de activación para configurar un sistema a la medida de tu negocio. Elige tu plan y <strong class="text-[--primary-color]">agenda una llamada</strong> o <strong class="text-[--primary-color]">añádelo al carrito</strong>.</p>
            </div>

            <div class="flex flex-wrap justify-center items-center gap-6 mb-12 p-4 bg-white rounded-full shadow-md max-w-lg mx-auto border">
                <span class="font-semibold">Pago Mensual</span>
                <label class="relative inline-flex items-center cursor-pointer">
                    <input type="checkbox" id="billing-toggle" class="sr-only peer">
                    <div class="w-14 h-8 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-1 after:left-[4px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-6 after:w-6 after:transition-all peer-checked:bg-[--primary-color]"></div>
                </label>
                <span class="font-semibold text-[--success-color]">Pago Anual (¡Ahorra 2 Meses!)</span>
            </div>
            
            <div class="overflow-x-auto rounded-2xl border shadow-md">
                <table class="automation-table">
                    <!-- Automation table will be populated by JS -->
                </table>
            </div>
        </div>
    </section>
    
    <!-- Add-ons & Training Sections -->
    <section class="section py-20" id="addons">
        <div class="container mx-auto px-5">
            <h2 class="text-4xl md:text-5xl font-extrabold text-center mb-4 text-[--dark-color]">Soluciones Adicionales</h2>
            <p class="text-center text-lg text-gray-600 max-w-3xl mx-auto mb-12">Potencia tu plan con estas herramientas y servicios especializados.</p>
            <div class="grid grid-cols-2 lg:grid-cols-3 gap-6" id="addons-container">
                <!-- Add-ons will be populated by JS -->
            </div>
        </div>
    </section>
    
    <section class="section py-20 bg-gray-50" id="training">
        <div class="container mx-auto px-5">
            <h2 class="text-4xl md:text-5xl font-extrabold text-center mb-4 text-[--dark-color]">Capacitación & Consultoría IA</h2>
            <p class="text-center text-lg text-gray-600 max-w-3xl mx-auto mb-12">Maximiza el potencial de la IA en tu negocio con nuestro apoyo experto.</p>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6" id="training-container">
                <!-- Training services will be populated by JS -->
            </div>
        </div>
    </section>

    <!-- FAQ Section -->
    <section id="faq" class="section py-20 bg-[--light-color]">
        <div class="container mx-auto px-5">
            <h2 class="text-4xl md:text-5xl font-extrabold text-center mb-12 text-[--dark-color]">Preguntas Frecuentes</h2>
            <div class="max-w-3xl mx-auto space-y-4">
                <div class="faq-item bg-white rounded-2xl shadow-md overflow-hidden border">
                    <div class="faq-question p-6 font-semibold text-lg cursor-pointer flex justify-between items-center hover:bg-gray-50 transition-colors">¿Diferencia entre planes de "Automatización" y "AI Chat"?<i class="fas fa-chevron-down transition-transform duration-300"></i></div>
                    <div class="faq-answer max-h-0 overflow-hidden transition-all duration-500 ease-in-out"><p class="px-6 text-gray-600">¡Buena pregunta! Los <strong>Planes de Automatización</strong> son un servicio completo donde nosotros configuramos y gestionamos un bot de ventas para ti. Los <strong>Planes de AI Chat</strong> te dan acceso a nuestra herramienta para que tú la uses para crear contenido, escribir copys, etc.</p></div>
                </div>
                <div class="faq-item bg-white rounded-2xl shadow-md overflow-hidden border">
                    <div class="faq-question p-6 font-semibold text-lg cursor-pointer flex justify-between items-center hover:bg-gray-50 transition-colors">¿Por qué los planes de Automatización requieren una reunión?<i class="fas fa-chevron-down transition-transform duration-300"></i></div>
                    <div class="faq-answer max-h-0 overflow-hidden transition-all duration-500 ease-in-out"><p class="px-6 text-gray-600">Porque no ofrecemos un producto genérico. La reunión es crucial para entender tus objetivos y configurar tu bot de forma personalizada para que te dé los mejores resultados desde el primer día. Es parte de nuestro servicio premium.</p></div>
                </div>
            </div>
        </div>
    </section>
</main>

<footer class="bg-[--dark-color] text-gray-400 pt-16 pb-8">
    <div class="container mx-auto px-5">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-10 mb-12">
            <div class="footer-column">
                <a href="/"><img src="logos hd.png" alt="GOATIFY Logo" class="h-10 mb-4" onerror="this.onerror=null; this.src='https://placehold.co/150x45/6d28d9/ffffff?text=GOATIFY';"></a>
                <p class="text-base leading-relaxed max-w-xs">IA que vende por ti, mientras vives tu vida. Automatización inteligente para negocios ambiciosos.</p>
                <div class="flex space-x-4 mt-6">
                    <a href="https://www.instagram.com/goatify.ia/" target="_blank" aria-label="Instagram" class="text-2xl hover:text-[--accent-color] transition-all hover:-translate-y-1"><i class="fab fa-instagram"></i></a>
                    <a href="https://www.facebook.com/profile.php?id=61574864266396" target="_blank" aria-label="Facebook" class="text-2xl hover:text-[--accent-color] transition-all hover:-translate-y-1"><i class="fab fa-facebook-f"></i></a>
                    <a href="https://www.tiktok.com/@goatify_app" target="_blank" aria-label="TikTok" class="text-2xl hover:text-[--accent-color] transition-all hover:-translate-y-1"><i class="fab fa-tiktok"></i></a>
                </div>
            </div>
            <div>
                <h4 class="text-lg font-bold text-white mb-6">Navegación</h4>
                <ul class="space-y-3">
                    <li><a href="#web-designs" class="hover:text-[--accent-color] transition-colors">Páginas Web</a></li>
                    <li><a href="#automation-plans" class="hover:text-[--accent-color] transition-colors">Automatización</a></li>
                    <li><a href="#ai-chat-plans" class="hover:text-[--accent-color] transition-colors">AI Chat</a></li>
                </ul>
            </div>
             <div>
                <h4 class="text-lg font-bold text-white mb-6">Legal</h4>
                <ul class="space-y-3">
                    <li><a class="policy-link cursor-pointer hover:text-[--accent-color] transition-colors" data-policy="general">Políticas Generales</a></li>
                    <li><a class="policy-link cursor-pointer hover:text-[--accent-color] transition-colors" data-policy="privacy">Política de Privacidad</a></li>
                </ul>
            </div>
            <div>
                <h4 class="text-lg font-bold text-white mb-6">Contacto</h4>
                <ul class="space-y-3">
                    <li><a href="mailto:info@goatify.app" class="flex items-center gap-3 hover:text-[--accent-color] transition-colors"><i class="fas fa-envelope w-5"></i> info@goatify.app</a></li>
                    <li><a href="https://wa.me/17439106116" target="_blank" class="flex items-center gap-3 hover:text-[--accent-color] transition-colors"><i class="fab fa-whatsapp w-5"></i> WhatsApp</a></li>
                    <li><a href="https://calendly.com/goatify" target="_blank" class="flex items-center gap-3 hover:text-[--accent-color] transition-colors"><i class="fas fa-calendar-alt w-5"></i> Agendar Reunión</a></li>
                </ul>
            </div>
        </div>
        <div class="text-center pt-8 border-t border-gray-700 text-sm text-gray-500">
            <p>&copy; <span id="currentYear"></span> GOATIFY IA. Todos los derechos reservados.</p>
        </div>
    </div>
</footer>

<!-- MODALS & FABs -->
<div class="modal-overlay hidden fixed inset-0 bg-black/60 backdrop-blur-sm z-[2000] items-center justify-center" id="cartModal">
    <div class="modal-content bg-white w-11/12 max-w-md rounded-2xl shadow-2xl flex flex-col max-h-[85vh] relative">
        <div class="p-6 border-b flex justify-between items-center">
            <h3 class="text-2xl font-bold">🛒 Tu Carrito</h3>
            <button class="close-modal-btn text-3xl text-gray-400 hover:text-[--danger-color]" data-target="#cartModal">&times;</button>
        </div>
        <div class="p-6 flex-grow overflow-y-auto" id="cartItemsContainer"></div>
        <div class="p-6 border-t font-bold text-right">
            <span class="text-xl" id="cartTotalLocal"></span>
            <span class="text-sm text-gray-500" id="cartTotalUSD"></span>
        </div>
        <div class="p-6 bg-gray-50 rounded-b-2xl">
            <button class="btn btn-primary w-full" id="cartCheckoutBtn"><i class="fab fa-whatsapp"></i> Finalizar por WhatsApp</button>
        </div>
    </div>
</div>

<div class="modal-overlay hidden fixed inset-0 bg-black/60 backdrop-blur-sm z-[2000] items-center justify-center" id="legalModal">
    <div class="modal-content bg-white w-11/12 max-w-3xl rounded-2xl shadow-2xl flex flex-col max-h-[85vh] relative">
        <div class="p-6 border-b flex justify-between items-center">
            <h3 class="text-2xl font-bold" id="legalModalTitle"></h3>
            <button class="close-modal-btn text-3xl text-gray-400 hover:text-[--danger-color]" data-target="#legalModal">&times;</button>
        </div>
        <div class="modal-body p-8 overflow-y-auto prose max-w-none" id="legalModalBody"></div>
    </div>
</div>

<div class="cart-fab" id="cartFab">
    <i class="fas fa-shopping-cart"></i>
    <span class="cart-badge hidden absolute top-[-5px] right-[-5px] bg-[--danger-color] text-white w-6 h-6 rounded-full text-xs font-bold flex items-center justify-center" id="cartBadge">0</span>
</div>

<div class="toast-message" id="toastMessage"></div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    // --- DATA SOURCES (Updated) ---
    const automationPlans = [
        { id: 'auto_trial', name: 'TRIAL GRATUITO 🧪', description: 'Prueba el poder de nuestra IA por 7 días.', price_usd: 0, price_annual: 0, type: 'automation', popular: false },
        { id: 'auto_sales_pro', name: 'Sales Pro 🚀', description: 'La solución ideal para crecer y vender más.', price_usd: 47, price_annual: 470, type: 'automation', popular: true },
        { id: 'auto_business', name: 'BUSINESS PRO 🌟', description: 'Máxima potencia y herramientas avanzadas.', price_usd: 77, price_annual: 770, type: 'automation', popular: false },
    ];

    const automationFeatures = [
        { category: 'Capacidades del Bot', features: [
            { name: 'Chatbot con IA (GPT-3.5 Turbo)', plans: [true, true, true] },
            { name: 'Flujo conversacional con cierre de ventas', plans: [false, true, true] },
            { name: 'Automatización Redes Sociales (FB/IG)', plans: [false, false, true] },
            { name: 'Acceso a API y CRM Básico', plans: [false, false, true] }
        ]},
        { category: 'Beneficios y Herramientas', features: [
            { name: 'Página Web Smart GRATIS', plans: [false, true, true] },
            { name: 'Página Web Smart Avanzada', plans: [false, false, true] },
            { name: 'Reportes de rendimiento básicos', plans: [true, true, true] }
        ]},
        { category: 'Soporte y Estrategia', features: [
            { name: 'Configuración inicial asistida', plans: [true, true, true] },
            { name: 'Reunión virtual completa con estratega', plans: [false, true, true] },
            { name: 'Gestión Ads Básica con IA', plans: [false, false, true] },
            { name: 'Consultoría Estratégica IA personalizada', plans: [false, false, { star: true }] },
            { name: 'Prioridad en Nuevas Funcionalidades', plans: [false, false, { star: true }] }
        ]}
    ];

    const webSmartPlans = [
        { id: 'web_smart', name: 'Web Smart', description: 'Aumenta tus ventas y conecta con clientes.', price_usd: 47, period: 'pago único', popular: false, features: ['Sitio Web de hasta 5 secciones', 'Diseño 100% personalizado', 'Carrito de compras', 'Optimización SEO', 'Chatbot integrado'], buttonText: 'Iniciar Proyecto', guarantee: 'Si no quedas satisfecho te devolvemos tu dinero' },
        { id: 'web_smart_pro', name: 'Web Smart PRO', description: 'Conecta, vende y crece a otro nivel.', price_usd: 97, period: 'pago único', popular: true, features: ['Diseño 100% personalizado', 'Carrito de compras', 'Chatbot integrado', 'Integración de Pagos (PayPal)', 'Blog o Portafolio dinámico', 'Optimización SEO Avanzada'], buttonText: 'Elegir Este Plan', guarantee: 'Si no quedas satisfecho te devolvemos tu dinero' },
        { id: 'web_ecommerce_smart', name: 'E-commerce', description: 'Vende tus productos online con IA.', price_usd: 147, period: 'pago único', popular: false, features: ['Secciones ilimitadas', 'Diseño 100% personalizado', 'Carrito de compras', 'Chatbot integrado', 'Integración de Pagos (PayPal)', 'Tienda online completa y optimizada', 'Sistema de gestión de pedidos', 'Carga inicial de hasta 20 productos'], buttonText: 'Empezar a Vender', guarantee: 'Si no quedas satisfecho te devolvemos tu dinero' }
    ];

    const aiChatPlans = [
        {
            id: 'ai_free',
            name: 'Free',
            price_usd: 0,
            period: 'Para Siempre',
            popular: false,
            features: [
                { text: '<strong>100 créditos</strong> / mes', icon: 'fa-check-circle', color: 'text-[--success-color]' },
                { text: 'Acceso al chat estándar', icon: 'fa-check-circle', color: 'text-[--success-color]' },
                { text: 'Historial ilimitado de chats', icon: 'fa-check-circle', color: 'text-[--success-color]' },
                { text: 'Organización por Proyectos', icon: 'fa-check-circle', color: 'text-[--success-color]' },
                { text: 'Acceso a plantillas de prompts', icon: 'fa-check-circle', color: 'text-[--success-color]' }
            ],
            buttonText: 'Empezar Gratis',
            buttonClass: 'btn-outline'
        },
        {
            id: 'ai_pro',
            name: 'GOAT PRO',
            price_usd: 7,
            period: '/ mes',
            popular: true,
            features: [
                { text: '<strong>4,000 créditos</strong> / mes', icon: 'fa-star', color: 'text-[--primary-color]' },
                { text: 'Acceso a <strong>todos los modelos de IA</strong>', icon: 'fa-check-circle', color: 'text-[--success-color]' },
                { text: 'Acceso a <strong>todos los Workflows</strong>', icon: 'fa-check-circle', color: 'text-[--success-color]' },
                { text: 'Página Web Smart <strong>Gratis</strong>', icon: 'fa-check-circle', color: 'text-[--success-color]' },
                { text: 'Comunidad privada y webinars', icon: 'fa-check-circle', color: 'text-[--success-color]' },
                { text: 'Soporte prioritario 1-a-1', icon: 'fa-check-circle', color: 'text-[--success-color]' }
            ],
            buttonText: 'Quiero mi plan PRO',
            buttonClass: 'btn-primary'
        }
    ];

    const addOns = [
        { id: 'addon_domain', name: 'Dominio Personalizado', description: 'Compra y configuración de tu dominio profesional (ej. tumarca.com). Incluye certificado SSL.', price_usd: 20, period: 'anual', icon: 'fa-globe' },
        { id: 'addon_branding', name: 'Kit de Branding IA', description: 'Creación de logo, paleta de colores y tipografías con IA para una identidad de marca profesional y coherente.', price_usd: 40, period: 'pago único', icon: 'fa-palette' },
        { id: 'addon_social', name: 'Social Autopilot PRO', description: 'Automatización mensual de publicaciones e interacciones en Instagram, Facebook y TikTok, optimizadas con IA.', price_usd: 50, period: 'mes', icon: 'fa-share-alt' },
        { id: 'addon_ads', name: 'Ads Autopilot', description: 'Creación y optimización de campañas en Meta y Google Ads, impulsadas por IA para máximo ROI.', price_usd: 50, period: 'mes', icon: 'fa-bullseye' },
        { id: 'addon_email', name: 'Email Marketing IA', description: 'Automatización de campañas de email con embudos de venta, secuencias de bienvenida y recuperación de leads.', price_usd: 50, period: 'mes', icon: 'fa-envelope-open-text' },
        { id: 'addon_video', name: 'Video IA Promos', description: 'Videos promocionales generados por IA, perfectos para reels, TikTok, historias y anuncios de alto impacto.', price_usd: 50, period: 'mes', icon: 'fa-video' },
        { id: 'addon_seo', name: 'SEO Avanzado y Blog', description: 'Estrategia de contenido y optimización SEO continua para posicionar tu web en los primeros lugares de Google.', price_usd: 60, period: 'mes', icon: 'fa-magnifying-glass-chart' },
        { id: 'addon_crm', name: 'Integración CRM', description: 'Conectamos tu sistema de automatización con tu CRM (HubSpot, Salesforce, etc.) para un flujo de datos unificado.', price_usd: 70, period: 'pago único', icon: 'fa-people-arrows' },
        { id: 'addon_reports', name: 'Reportes Inteligentes Pro', description: 'Análisis mensual de rendimiento con IA, incluyendo tasa de conversión, sugerencias y proyecciones de crecimiento.', price_usd: 20, period: 'mes', icon: 'fa-chart-line' }
    ];

    const trainingServices = [
        { id: 'train_initial', name: 'Video de Capacitación Inicial', description: 'Tutorial personalizado con acceso a panel y recomendaciones de uso para un inicio rápido.', price_usd: 0, period: 'Incluido', icon: 'fa-video' },
        { id: 'train_advanced', name: 'Capacitación Personalizada Avanzada', description: 'Reunión de 1 hora por Zoom para entrenarte o capacitar a tu equipo en el uso avanzado de GOATIFY IA.', price_usd: 30, period: 'hora', icon: 'fa-users' },
        { id: 'train_consult', name: 'Consultoría IA Estratégica Premium', description: 'Diagnóstico profundo + plan de automatización y mejora de procesos específicos de tu negocio con IA.', price_usd: 30, period: 'hora', icon: 'fa-brain' },
        { id: 'train_webinar', name: 'Webinars Mensuales Expertos', description: 'Masterclass exclusivas sobre IA para negocios, últimas tendencias y estrategias de venta con expertos.', price_usd: 0, period: 'Gratis', icon: 'fa-microphone-alt' }
    ];

    const legalPolicies = {
        general: { title: "Políticas Generales", content: `<h5>1. Aceptación de los Términos</h5><p>Al acceder y utilizar los servicios de GOATIFY IA, usted acepta estar sujeto a estos términos y condiciones. Si no está de acuerdo con alguna parte de los términos, no podrá utilizar nuestros servicios.</p><h5>2. Modificaciones</h5><p>GOATIFY IA se reserva el derecho de modificar o reemplazar estos Términos en cualquier momento. Es su responsabilidad revisar periódicamente los cambios. El uso continuado del servicio después de la publicación de cualquier cambio constituye la aceptación de dichos cambios.</p><h5>3. Uso del Servicio</h5><p>Usted se compromete a no utilizar el servicio para ningún propósito ilegal o no autorizado. Usted es responsable de toda la actividad que ocurra bajo su cuenta.</p>` },
        privacy: { title: "Política de Privacidad", content: `<h5>1. Recopilación de Información</h5><p>Recopilamos información que usted nos proporciona directamente, como su nombre, correo electrónico y datos de pago. También recopilamos información automáticamente cuando utiliza nuestros servicios, como datos de uso e información del dispositivo.</p><h5>2. Uso de la Información</h5><p>Utilizamos la información recopilada para proporcionar, mantener y mejorar nuestros servicios, procesar transacciones, comunicarnos con usted y personalizar su experiencia.</p><h5>3. Intercambio de Información</h5><p>No compartimos su información personal con terceros, excepto según sea necesario para proporcionar nuestros servicios (por ejemplo, con procesadores de pago) o si así lo exige la ley.</p>` }
    };

    // --- DYNAMIC CONTENT POPULATION ---
    function populateAutomationPlans() {
        const tableContainer = document.querySelector('.automation-table');
        if (!tableContainer) return;

        let tableHead = `<thead><tr><th class="w-1/4"></th>`;
        automationPlans.forEach(plan => {
            tableHead += `<th class="plan-header w-1/4 ${plan.popular ? 'popular' : ''}">
                ${plan.popular ? '<div class="inline-block bg-gradient-to-r from-[--primary-color] to-[--secondary-color] text-white px-4 py-1.5 text-xs font-bold rounded-full mb-2.5">MÁS POPULAR</div>' : ''}
                <h3 class="text-lg font-bold text-[--dark-color]">${plan.name}</h3>
                <p class="text-xs text-gray-500 font-medium min-h-[30px] mt-1">${plan.description}</p>
                <div class="plan-price text-3xl font-extrabold text-[--primary-color] my-2" data-price-usd="${plan.price_usd}" data-price-annual="${plan.price_annual}"></div>
                <p class="price-period text-xs font-medium text-gray-600 min-h-[1rem]"></p>
                <div class="flex flex-col gap-2 items-center justify-center mt-3">
                    <a href="https://calendly.com/goatify" target="_blank" class="btn ${plan.popular ? 'btn-primary' : 'btn-outline'} w-full btn-sm"><i class="fas fa-calendar-alt"></i> Agendar</a>
                    <button class="btn btn-accent btn-sm w-full add-to-cart-btn" data-id="${plan.id}" data-type="automation">+ Añadir</button>
                </div>
            </th>`;
        });
        tableHead += `</tr></thead>`;

        let tableBody = `<tbody>`;
        automationFeatures.forEach(category => {
            tableBody += `<tr class="feature-category-row"><td colspan="${automationPlans.length + 1}">${category.category}</td></tr>`;
            category.features.forEach(feature => {
                tableBody += `<tr><td class="feature-name text-left font-medium pl-4">${feature.name}</td>`;
                feature.plans.forEach(planFeature => {
                    if (planFeature === true) tableBody += `<td><i class="fas fa-check-circle feature-check"></i></td>`;
                    else if (planFeature === false) tableBody += `<td><span class="feature-dash">—</span></td>`;
                    else if (planFeature.star) tableBody += `<td><i class="fas fa-star feature-star"></i></td>`;
                });
                tableBody += `</tr>`;
            });
        });
        tableBody += `</tbody>`;
        tableContainer.innerHTML = tableHead + tableBody;
    }

    function populateAiChatPlans() {
        const container = document.getElementById('ai-chat-container');
        if (!container) return;
        container.innerHTML = aiChatPlans.map(plan => `
            <div class="pricing-card ${plan.popular ? 'popular' : ''} bg-white rounded-3xl shadow-lg p-6 flex flex-col">
                ${plan.popular ? '<div class="absolute top-0 left-1/2 -translate-x-1/2 bg-gradient-to-r from-[--primary-color] to-[--secondary-color] text-white px-6 py-2 rounded-b-xl font-bold text-sm tracking-wider">PLAN PRO</div>' : ''}
                <h3 class="text-2xl font-extrabold ${plan.popular ? 'mt-10' : ''}">${plan.name}</h3>
                <div class="plan-price text-5xl font-extrabold my-4" data-price-usd="${plan.price_usd}">${plan.price_usd === 0 ? 'Gratis' : ''}</div>
                <p class="text-gray-500">${plan.period}</p>
                <div class="my-6 border-t pt-6">
                    <ul class="space-y-3 text-left flex-grow text-sm">
                        ${plan.features.map(f => `<li class="flex items-start gap-3"><i class="fas ${f.icon} ${f.color} mt-1"></i><span>${f.text}</span></li>`).join('')}
                    </ul>
                </div>
                <a href="https://www.goatify.app" target="_blank" class="btn ${plan.buttonClass} w-full mt-auto">${plan.buttonText}</a>
            </div>
        `).join('');
    }

    function createWebPlanCard(plan) {
        return `
            <div class="pricing-card ${plan.popular ? 'popular' : ''} bg-white rounded-3xl shadow-lg p-6 flex flex-col relative overflow-hidden">
                ${plan.popular ? '<div class="absolute top-0 left-1/2 -translate-x-1/2 bg-gradient-to-r from-[--primary-color] to-[--secondary-color] text-white px-6 py-2 rounded-b-xl font-bold text-sm tracking-wider">MÁS POPULAR</div>' : ''}
                <h3 class="text-xl font-extrabold ${plan.popular ? 'mt-10' : ''}">${plan.name}</h3>
                <p class="text-gray-500 my-2 text-sm">${plan.description}</p>
                <div class="plan-price text-4xl font-extrabold my-3" data-price-usd="${plan.price_usd}"></div>
                <p class="plan-period text-gray-500 text-sm">${plan.period}</p>
                <ul class="space-y-3 my-5 text-left flex-grow text-sm">
                    ${plan.features.map(feature => `<li class="flex items-start gap-3"><i class="fas fa-check-circle text-[--success-color] mt-1"></i><span>${feature}</span></li>`).join('')}
                </ul>
                <button class="btn ${plan.popular ? 'btn-primary' : 'btn-outline'} add-to-cart-btn w-full mt-auto" data-id="${plan.id}" data-type="web">${plan.buttonText}</button>
                ${plan.guarantee ? `<p class="text-center text-xs text-gray-500 mt-3 font-semibold">${plan.guarantee}</p>` : ''}
            </div>
        `;
    }

    function createServiceCard(item, type) {
        const button = item.price_usd > 0 
            ? `<button class="btn btn-accent btn-sm add-to-cart-btn mt-auto w-full" data-id="${item.id}" data-type="${type}">+ Añadir</button>`
            : `<div class="mt-auto w-full h-[35px]"></div>`;
        const priceText = item.price_usd > 0 ? '' : (item.period === 'Gratis' ? 'Gratis' : 'Incluido');

        return `
            <div class="bg-white rounded-3xl shadow-lg p-6 flex flex-col text-center transition-transform duration-300 hover:-translate-y-2 border">
                <i class="fas ${item.icon} text-4xl text-[--primary-color] mb-4"></i>
                <h3 class="text-xl font-bold text-[--dark-color] flex-grow">${item.name}</h3>
                <p class="text-gray-600 my-3 min-h-[80px] text-sm">${item.description}</p>
                <div class="plan-price text-3xl font-extrabold text-[--secondary-color] my-2" data-price-usd="${item.price_usd}">${priceText}</div>
                <p class="plan-period text-gray-500 mb-5 text-sm">${item.period}</p>
                ${button}
            </div>
        `;
    }
    
    function populateServiceSections() {
        document.getElementById('web-designs-container').innerHTML = webSmartPlans.map(createWebPlanCard).join('');
        document.getElementById('addons-container').innerHTML = addOns.map(item => createServiceCard(item, 'addon')).join('');
        document.getElementById('training-container').innerHTML = trainingServices.map(item => createServiceCard(item, 'training')).join('');
    }
    
    // --- GENERAL SCRIPT ---
    document.getElementById('currentYear').textContent = new Date().getFullYear();
    document.querySelectorAll('.faq-question').forEach(q => q.addEventListener('click', () => q.parentElement.classList.toggle('active')));

    // --- COUNTDOWN TIMER ---
    function startCountdown() {
        const countdownElement = document.getElementById('countdown-timer');
        if (!countdownElement) return;

        let targetDate = new Date();
        targetDate.setDate(targetDate.getDate() + 3); // Set offer to end in 3 days from now
        targetDate.setHours(23, 59, 59, 999);

        const interval = setInterval(() => {
            const now = new Date().getTime();
            const distance = targetDate - now;

            if (distance < 0) {
                clearInterval(interval);
                countdownElement.innerHTML = "<p>¡Oferta Terminada!</p>";
                return;
            }

            const days = Math.floor(distance / (1000 * 60 * 60 * 24));
            const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((distance % (1000 * 60)) / 1000);

            countdownElement.innerHTML = `
                <div class="countdown-item"><span class="countdown-number">${String(days).padStart(2, '0')}</span><span class="countdown-label">Días</span></div>
                <div class="countdown-item"><span class="countdown-number">${String(hours).padStart(2, '0')}</span><span class="countdown-label">Hrs</span></div>
                <div class="countdown-item"><span class="countdown-number">${String(minutes).padStart(2, '0')}</span><span class="countdown-label">Min</span></div>
                <div class="countdown-item"><span class="countdown-number">${String(seconds).padStart(2, '0')}</span><span class="countdown-label">Seg</span></div>
            `;
        }, 1000);
    }

    // --- MODAL LOGIC ---
    const cartModal = document.getElementById('cartModal');
    const legalModal = document.getElementById('legalModal');
    document.querySelectorAll('.close-modal-btn').forEach(btn => btn.addEventListener('click', () => document.querySelector(btn.dataset.target).style.display = 'none'));
    window.addEventListener('click', (e) => { if (e.target.classList.contains('modal-overlay')) e.target.style.display = 'none'; });
    document.querySelectorAll('.policy-link').forEach(link => {
        link.addEventListener('click', (e) => {
            const policy = legalPolicies[e.target.dataset.policy];
            document.getElementById('legalModalTitle').textContent = policy.title;
            document.getElementById('legalModalBody').innerHTML = policy.content;
            legalModal.style.display = 'flex';
        });
    });

    // --- PRICING & CURRENCY ---
    const billingToggle = document.getElementById('billing-toggle');
    const currencySelector = document.getElementById('currency-selector');
    const currencyData = {
        USD: { symbol: '$', rate: 1, format: p => `$${p.toFixed(2)}` },
        EUR: { symbol: '€', rate: 0.93, format: p => `€${p.toFixed(2)}` },
        MXN: { symbol: '$', rate: 18.5, format: p => `$${p.toLocaleString('es-MX', {minimumFractionDigits: 2, maximumFractionDigits: 2})}` },
        CLP: { symbol: '$', rate: 930, format: p => `$${Math.round(p).toLocaleString('es-CL')}` },
        PEN: { symbol: 'S/', rate: 3.75, format: p => `S/${p.toLocaleString('es-PE', {minimumFractionDigits: 2, maximumFractionDigits: 2})}` },
        COP: { symbol: '$', rate: 4100, format: p => `$${Math.round(p).toLocaleString('es-CO')}` },
        ARS: { symbol: '$', rate: 910, format: p => `$${p.toLocaleString('es-AR', {minimumFractionDigits: 2, maximumFractionDigits: 2})}` },
        UYU: { symbol: '$U', rate: 39, format: p => `$U${Math.round(p).toLocaleString('es-UY')}` },
        CAD: { symbol: '$', rate: 1.37, format: p => `$${p.toFixed(2)}` }
    };

    function updatePrices() {
        const isAnnual = billingToggle.checked;
        const currency = currencyData[currencySelector.value];
        
        document.querySelectorAll('[data-price-usd]').forEach(el => {
            let basePriceUSD = parseFloat(el.dataset.priceUsd);
            if (isNaN(basePriceUSD)) return;
            if (basePriceUSD === 0) {
                if (!el.textContent.includes('Gratis')) el.textContent = 'Gratis';
                return;
            }
            if (el.closest('#automation-plans')) {
                const annualPrice = parseFloat(el.dataset.priceAnnual);
                if (!isNaN(annualPrice)) basePriceUSD = isAnnual ? annualPrice : basePriceUSD;
            }
            el.textContent = currency.format(basePriceUSD * currency.rate);
        });

        document.querySelectorAll('#automation-plans .price-period').forEach(el => {
            const priceEl = el.previousElementSibling;
            const basePrice = parseFloat(priceEl.dataset.priceUsd);
            if (basePrice === 0) { el.textContent = 'por 7 días'; } 
            else { el.textContent = isAnnual ? '/año' : '/mes'; }
        });
        updateCartUI(); 
    }

    // --- SHOPPING CART LOGIC ---
    let cart = [];
    const cartFab = document.getElementById('cartFab');
    const cartBadge = document.getElementById('cartBadge');
    const cartItemsContainer = document.getElementById('cartItemsContainer');
    const cartTotalLocal = document.getElementById('cartTotalLocal');
    const cartTotalUSD = document.getElementById('cartTotalUSD');
    const toastMessage = document.getElementById('toastMessage');

    function showToast(message) {
        toastMessage.textContent = message;
        toastMessage.classList.add('show');
        setTimeout(() => toastMessage.classList.remove('show'), 3000);
    }

    function handleAddToCart(event) {
        const button = event.target.closest('.add-to-cart-btn');
        const itemId = button.dataset.id;
        const itemType = button.dataset.type;
        const isAnnual = billingToggle.checked;
        
        let sourceArray;
        switch(itemType) {
            case 'automation': sourceArray = automationPlans; break;
            case 'web': sourceArray = webSmartPlans; break;
            case 'addon': sourceArray = addOns; break;
            case 'training': sourceArray = trainingServices; break;
            case 'ai_chat': sourceArray = aiChatPlans; break;
        }
        const itemData = sourceArray.find(p => p.id === itemId);
        if (!itemData) return;

        const newItem = {
            id: itemData.id,
            name: itemData.name,
            price_usd: (itemType === 'automation' && isAnnual) ? itemData.price_annual : itemData.price_usd,
            period: (itemType === 'automation') ? (isAnnual ? 'Anual' : 'Mensual') : itemData.period,
            type: itemType
        };

        if (cart.some(item => item.id === newItem.id)) {
            showToast(`"${newItem.name}" ya está en el carrito.`);
            return;
        }
        
        if (itemType === 'automation') cart = cart.filter(item => item.type !== 'automation');
        
        cart.push(newItem);
        showToast(`"${itemData.name}" añadido al carrito.`);
        updateCartUI();
    }

    function updateCartUI() {
        cartBadge.textContent = cart.length;
        cartBadge.classList.toggle('hidden', cart.length === 0);
        
        if (cart.length === 0) {
            cartItemsContainer.innerHTML = `<p class="text-center text-gray-500 py-10 italic">Tu carrito está vacío.</p>`;
            cartTotalLocal.textContent = '';
            cartTotalUSD.textContent = '';
            return;
        }

        let totalUSD = 0;
        const currency = currencyData[currencySelector.value];
        cartItemsContainer.innerHTML = cart.map(item => {
            totalUSD += item.price_usd;
            return `
            <div class="flex justify-between items-center py-3 border-b">
                <div>
                    <span class="font-semibold">${item.name}</span>
                    <span class="block text-sm text-gray-500">${currency.format(item.price_usd * currency.rate)} (${item.period})</span>
                </div>
                <button class="cart-item-remove text-xl text-[--danger-color] hover:text-red-700" data-id="${item.id}">&times;</button>
            </div>`;
        }).join('');
        
        cartTotalLocal.textContent = `Total: ${currency.format(totalUSD * currency.rate)} ${currencySelector.value}`;
        cartTotalUSD.textContent = currencySelector.value !== 'USD' ? `(Equivalente a $${totalUSD.toFixed(2)} USD)` : '';

        document.querySelectorAll('.cart-item-remove').forEach(btn => {
            btn.addEventListener('click', (e) => {
                cart = cart.filter(item => item.id !== e.target.dataset.id);
                updateCartUI();
            });
        });
    }
    
    function checkout() {
        if (cart.length === 0) return;
        let message = "¡Hola GOATIFY! 👋 Me gustaría comprar lo siguiente:\n\n";
        cart.forEach(item => {
            message += `*Producto:* ${item.name}\n*Tipo:* ${item.period}\n*Precio:* $${item.price_usd.toFixed(2)} USD\n---\n`;
        });
        const totalUSD = cart.reduce((sum, item) => sum + item.price_usd, 0);
        message += `\n*TOTAL:* $${totalUSD.toFixed(2)} USD\n\nPor favor, contáctenme para finalizar la compra. ¡Gracias! 😊`;
        window.open(`https://wa.me/17439106116?text=${encodeURIComponent(message)}`, '_blank');
    }

    // --- INITIALIZATION ---
    populateAutomationPlans();
    populateAiChatPlans();
    populateServiceSections();
    startCountdown();
    updatePrices();
    
    billingToggle.addEventListener('change', updatePrices);
    currencySelector.addEventListener('change', updatePrices);
    cartFab.addEventListener('click', () => cartModal.style.display = 'flex');
    document.getElementById('cartCheckoutBtn').addEventListener('click', checkout);
    document.body.addEventListener('click', (e) => {
        if (e.target.closest('.add-to-cart-btn')) handleAddToCart(e);
    });
});
</script>

</body>
</html>
